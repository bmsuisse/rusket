
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Ultra-fast Recommender Engines & Market Basket Analysis for Python, written in Rust.">
      
      
      
        <link rel="canonical" href="https://bmsuisse.github.io/rusket/api-reference/">
      
      
        <link rel="prev" href="../quickstart/">
      
      
        <link rel="next" href="../cookbook/">
      
      
        
      
      
      <link rel="icon" href="../assets/logo_single.svg">
      <meta name="generator" content="zensical-0.0.23">
    
    
      
        <title>API Reference - rusket</title>
      
    
    
      
        
      
      <link rel="stylesheet" href="../assets/stylesheets/modern/main.1e989742.min.css">
      
        
          
        
        <link rel="stylesheet" href="../assets/stylesheets/modern/palette.dfe2e883.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)),0),__md_get=(e,t=localStorage,a=__md_scope)=>JSON.parse(t.getItem(a.pathname+"."+e)),__md_set=(e,t,a=localStorage,_=__md_scope)=>{try{a.setItem(_.pathname+"."+e,JSON.stringify(t))}catch(e){}},document.documentElement.setAttribute("data-platform",navigator.platform)</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="./.." title="rusket" class="md-header__button md-logo" aria-label="rusket" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-shopping-basket" viewBox="0 0 24 24"><path d="m15 11-1 9M19 11l-4-7M2 11h20M3.5 11l1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4M4.5 15.5h15M5 11l4-7M9 11l1 9"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-menu" viewBox="0 0 24 24"><path d="M4 5h16M4 12h16M4 19h16"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            rusket
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="none" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-sun" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/><path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="none" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-moon" viewBox="0 0 24 24"><path d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-search" viewBox="0 0 24 24"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog" aria-label="Search">
  <button type="button" class="md-search__button">
    Search
  </button>
</div>
      
    
    <div class="md-header__source">
      
    </div>
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="./.." title="rusket" class="md-nav__button md-logo" aria-label="rusket" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-shopping-basket" viewBox="0 0 24 24"><path d="m15 11-1 9M19 11l-4-7M2 11h20M3.5 11l1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4M4.5 15.5h15M5 11l4-7M9 11l1 9"/></svg>

    </a>
    rusket
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="./.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="././" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functional-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functional API
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functional API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mine" class="md-nav__link">
    <span class="md-ellipsis">
      
        mine
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpgrowth" class="md-nav__link">
    <span class="md-ellipsis">
      
        fpgrowth
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eclat" class="md-nav__link">
    <span class="md-ellipsis">
      
        eclat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#association_rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        association_rules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefixspan" class="md-nav__link">
    <span class="md-ellipsis">
      
        prefixspan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hupm" class="md-nav__link">
    <span class="md-ellipsis">
      
        hupm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequences_from_event_log" class="md-nav__link">
    <span class="md-ellipsis">
      
        sequences_from_event_log
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mine_hupm" class="md-nav__link">
    <span class="md-ellipsis">
      
        mine_hupm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mine_duckdb" class="md-nav__link">
    <span class="md-ellipsis">
      
        mine_duckdb
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mine_spark" class="md-nav__link">
    <span class="md-ellipsis">
      
        mine_spark
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_transactions" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_transactions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_transactions_csr" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_transactions_csr
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_pandas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_spark" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_spark
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_arrow" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_arrow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate" class="md-nav__link">
    <span class="md-ellipsis">
      
        evaluate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train_test_split" class="md-nav__link">
    <span class="md-ellipsis">
      
        train_test_split
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leave_one_out_split" class="md-nav__link">
    <span class="md-ellipsis">
      
        leave_one_out_split
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pca" class="md-nav__link">
    <span class="md-ellipsis">
      
        pca
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pca2" class="md-nav__link">
    <span class="md-ellipsis">
      
        pca2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pca3" class="md-nav__link">
    <span class="md-ellipsis">
      
        pca3
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oop-mining-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        OOP Mining API
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OOP Mining API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fpgrowth_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGrowth
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FPGrowth">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fpgrowthmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGrowth.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eclat_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Eclat
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Eclat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eclatmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        Eclat.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autominer" class="md-nav__link">
    <span class="md-ellipsis">
      
        AutoMiner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AutoMiner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autominermine" class="md-nav__link">
    <span class="md-ellipsis">
      
        AutoMiner.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefixspan_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        PrefixSpan
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PrefixSpan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefixspanmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        PrefixSpan.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hupm_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        HUPM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HUPM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hupmmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        HUPM.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpminer" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FPMiner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fpmineradd_arrow_batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.add_arrow_batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpmineradd_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.add_chunk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpminerfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpminermine" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.mine
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpminerpredict" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpminerreset" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.reset
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fin" class="md-nav__link">
    <span class="md-ellipsis">
      
        FIN
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FIN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#finmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        FIN.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lcm" class="md-nav__link">
    <span class="md-ellipsis">
      
        LCM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LCM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lcmmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        LCM.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ruleminermixin-shared-miner-interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        RuleMinerMixin — Shared Miner Interface
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RuleMinerMixin — Shared Miner Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ruleminermixinassociation_rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        RuleMinerMixin.association_rules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ruleminermixinrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        RuleMinerMixin.recommend_items
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ruleminermixin_invalidate_rules_cache" class="md-nav__link">
    <span class="md-ellipsis">
      
        RuleMinerMixin._invalidate_rules_cache
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommenders" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommenders
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommenders">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#als" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ALS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alsbatch_recommend" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS.batch_recommend
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alsfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alsrecalculate_user" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS.recalculate_user
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alsrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS.recommend_items
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alsrecommend_users" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS.recommend_users
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bpr" class="md-nav__link">
    <span class="md-ellipsis">
      
        BPR
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BPR">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bprfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        BPR.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bprrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        BPR.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fm" class="md-nav__link">
    <span class="md-ellipsis">
      
        FM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fmfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        FM.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmpredict" class="md-nav__link">
    <span class="md-ellipsis">
      
        FM.predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmpredict_proba" class="md-nav__link">
    <span class="md-ellipsis">
      
        FM.predict_proba
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommender" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommender
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommender">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommenderpredict_next_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommender.predict_next_chunk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommenderrecommend_for_cart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommender.recommend_for_cart
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommenderrecommend_for_user" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommender.recommend_for_user
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextbestaction" class="md-nav__link">
    <span class="md-ellipsis">
      
        NextBestAction
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NextBestAction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nextbestactionpredict_next_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      
        NextBestAction.predict_next_chunk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextbestactionrecommend_for_cart" class="md-nav__link">
    <span class="md-ellipsis">
      
        NextBestAction.recommend_for_cart
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextbestactionrecommend_for_user" class="md-nav__link">
    <span class="md-ellipsis">
      
        NextBestAction.recommend_for_user
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ease" class="md-nav__link">
    <span class="md-ellipsis">
      
        EASE
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EASE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easefit" class="md-nav__link">
    <span class="md-ellipsis">
      
        EASE.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easerecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        EASE.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#itemknn" class="md-nav__link">
    <span class="md-ellipsis">
      
        ItemKNN
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ItemKNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#itemknnfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        ItemKNN.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#itemknnrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        ItemKNN.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpmc" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMC
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FPMC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fpmcfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMC.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpmcrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMC.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svd" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SVD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#svdbatch_recommend" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD.batch_recommend
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svdfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svdpredict" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD.predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svdrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD.recommend_items
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svdrecommend_users" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD.recommend_users
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lightgcn" class="md-nav__link">
    <span class="md-ellipsis">
      
        LightGCN
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LightGCN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lightgcnfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        LightGCN.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lightgcnrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        LightGCN.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sasrec" class="md-nav__link">
    <span class="md-ellipsis">
      
        SASRec
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SASRec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sasrecfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        SASRec.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sasrecrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        SASRec.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#popularityrecommender" class="md-nav__link">
    <span class="md-ellipsis">
      
        PopularityRecommender
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PopularityRecommender">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#popularityrecommenderfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        PopularityRecommender.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#popularityrecommenderrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        PopularityRecommender.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contentbased" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContentBased
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentBased">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contentbasedfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContentBased.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contentbasedrecommend_similar" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContentBased.recommend_similar
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybridrecommender" class="md-nav__link">
    <span class="md-ellipsis">
      
        HybridRecommender
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HybridRecommender">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hybridrecommenderfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        HybridRecommender.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybridrecommenderrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        HybridRecommender.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmf" class="md-nav__link">
    <span class="md-ellipsis">
      
        NMF
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NMF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nmffit" class="md-nav__link">
    <span class="md-ellipsis">
      
        NMF.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmfrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        NMF.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analytics-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analytics &amp; Utilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analytics &amp; Utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#score_potential" class="md-nav__link">
    <span class="md-ellipsis">
      
        score_potential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similar_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        similar_items
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_substitutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_substitutes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customer_saturation" class="md-nav__link">
    <span class="md-ellipsis">
      
        customer_saturation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export_item_factors" class="md-nav__link">
    <span class="md-ellipsis">
      
        export_item_factors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pca_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCA
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PCA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pcafit" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCA.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcafit_transform" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCA.fit_transform
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcatransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCA.transform
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipelinerecommend" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline.recommend
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipelinerecommend_batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline.recommend_batch
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization-rusketviz" class="md-nav__link">
    <span class="md-ellipsis">
      
        Visualization (rusket.viz)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualization (rusket.viz)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rusketvizto_networkx" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.viz.to_networkx
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#distributed-spark-api-rusketspark" class="md-nav__link">
    <span class="md-ellipsis">
      
        Distributed Spark API (rusket.spark)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Distributed Spark API (rusket.spark)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rusketsparkmine_grouped" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.mine_grouped
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusketsparkrules_grouped" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.rules_grouped
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusketsparkprefixspan_grouped" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.prefixspan_grouped
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusketsparkhupm_grouped" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.hupm_grouped
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusketsparkrecommend_batches" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.recommend_batches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusketsparkto_spark" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.to_spark
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cookbook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Notebooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Notebooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/1_online_retail_basket_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Online Retail & Basket Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/2_movielens_recommendations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MovieLens Recommendations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/3_ecommerce_lifecycle_mining/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    E-Commerce Lifecycle Mining
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recommender/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recommender Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pipeline API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streaming & Big Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PySpark Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../polars/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Polars Support
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmarks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1b-challenge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The 1B Challenge
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functional-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functional API
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functional API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mine" class="md-nav__link">
    <span class="md-ellipsis">
      
        mine
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpgrowth" class="md-nav__link">
    <span class="md-ellipsis">
      
        fpgrowth
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eclat" class="md-nav__link">
    <span class="md-ellipsis">
      
        eclat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#association_rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        association_rules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefixspan" class="md-nav__link">
    <span class="md-ellipsis">
      
        prefixspan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hupm" class="md-nav__link">
    <span class="md-ellipsis">
      
        hupm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequences_from_event_log" class="md-nav__link">
    <span class="md-ellipsis">
      
        sequences_from_event_log
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mine_hupm" class="md-nav__link">
    <span class="md-ellipsis">
      
        mine_hupm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mine_duckdb" class="md-nav__link">
    <span class="md-ellipsis">
      
        mine_duckdb
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mine_spark" class="md-nav__link">
    <span class="md-ellipsis">
      
        mine_spark
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_transactions" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_transactions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_transactions_csr" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_transactions_csr
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_pandas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_polars" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_polars
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_spark" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_spark
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_arrow" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_arrow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate" class="md-nav__link">
    <span class="md-ellipsis">
      
        evaluate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train_test_split" class="md-nav__link">
    <span class="md-ellipsis">
      
        train_test_split
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leave_one_out_split" class="md-nav__link">
    <span class="md-ellipsis">
      
        leave_one_out_split
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pca" class="md-nav__link">
    <span class="md-ellipsis">
      
        pca
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pca2" class="md-nav__link">
    <span class="md-ellipsis">
      
        pca2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pca3" class="md-nav__link">
    <span class="md-ellipsis">
      
        pca3
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oop-mining-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        OOP Mining API
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OOP Mining API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fpgrowth_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGrowth
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FPGrowth">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fpgrowthmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGrowth.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eclat_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Eclat
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Eclat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eclatmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        Eclat.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autominer" class="md-nav__link">
    <span class="md-ellipsis">
      
        AutoMiner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AutoMiner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autominermine" class="md-nav__link">
    <span class="md-ellipsis">
      
        AutoMiner.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefixspan_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        PrefixSpan
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PrefixSpan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefixspanmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        PrefixSpan.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hupm_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        HUPM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HUPM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hupmmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        HUPM.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpminer" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FPMiner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fpmineradd_arrow_batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.add_arrow_batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpmineradd_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.add_chunk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpminerfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpminermine" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.mine
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpminerpredict" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpminerreset" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMiner.reset
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fin" class="md-nav__link">
    <span class="md-ellipsis">
      
        FIN
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FIN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#finmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        FIN.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lcm" class="md-nav__link">
    <span class="md-ellipsis">
      
        LCM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LCM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lcmmine" class="md-nav__link">
    <span class="md-ellipsis">
      
        LCM.mine
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ruleminermixin-shared-miner-interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        RuleMinerMixin — Shared Miner Interface
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RuleMinerMixin — Shared Miner Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ruleminermixinassociation_rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        RuleMinerMixin.association_rules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ruleminermixinrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        RuleMinerMixin.recommend_items
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ruleminermixin_invalidate_rules_cache" class="md-nav__link">
    <span class="md-ellipsis">
      
        RuleMinerMixin._invalidate_rules_cache
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommenders" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommenders
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommenders">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#als" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ALS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alsbatch_recommend" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS.batch_recommend
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alsfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alsrecalculate_user" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS.recalculate_user
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alsrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS.recommend_items
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alsrecommend_users" class="md-nav__link">
    <span class="md-ellipsis">
      
        ALS.recommend_users
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bpr" class="md-nav__link">
    <span class="md-ellipsis">
      
        BPR
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BPR">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bprfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        BPR.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bprrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        BPR.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fm" class="md-nav__link">
    <span class="md-ellipsis">
      
        FM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fmfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        FM.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmpredict" class="md-nav__link">
    <span class="md-ellipsis">
      
        FM.predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fmpredict_proba" class="md-nav__link">
    <span class="md-ellipsis">
      
        FM.predict_proba
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommender" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommender
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommender">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommenderpredict_next_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommender.predict_next_chunk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommenderrecommend_for_cart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommender.recommend_for_cart
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommenderrecommend_for_user" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommender.recommend_for_user
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextbestaction" class="md-nav__link">
    <span class="md-ellipsis">
      
        NextBestAction
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NextBestAction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nextbestactionpredict_next_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      
        NextBestAction.predict_next_chunk
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextbestactionrecommend_for_cart" class="md-nav__link">
    <span class="md-ellipsis">
      
        NextBestAction.recommend_for_cart
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextbestactionrecommend_for_user" class="md-nav__link">
    <span class="md-ellipsis">
      
        NextBestAction.recommend_for_user
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ease" class="md-nav__link">
    <span class="md-ellipsis">
      
        EASE
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EASE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easefit" class="md-nav__link">
    <span class="md-ellipsis">
      
        EASE.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easerecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        EASE.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#itemknn" class="md-nav__link">
    <span class="md-ellipsis">
      
        ItemKNN
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ItemKNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#itemknnfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        ItemKNN.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#itemknnrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        ItemKNN.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpmc" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMC
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FPMC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fpmcfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMC.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpmcrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPMC.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svd" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SVD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#svdbatch_recommend" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD.batch_recommend
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svdfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svdpredict" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD.predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svdrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD.recommend_items
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#svdrecommend_users" class="md-nav__link">
    <span class="md-ellipsis">
      
        SVD.recommend_users
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lightgcn" class="md-nav__link">
    <span class="md-ellipsis">
      
        LightGCN
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LightGCN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lightgcnfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        LightGCN.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lightgcnrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        LightGCN.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sasrec" class="md-nav__link">
    <span class="md-ellipsis">
      
        SASRec
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SASRec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sasrecfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        SASRec.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sasrecrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        SASRec.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#popularityrecommender" class="md-nav__link">
    <span class="md-ellipsis">
      
        PopularityRecommender
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PopularityRecommender">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#popularityrecommenderfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        PopularityRecommender.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#popularityrecommenderrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        PopularityRecommender.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contentbased" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContentBased
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContentBased">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contentbasedfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContentBased.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contentbasedrecommend_similar" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContentBased.recommend_similar
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybridrecommender" class="md-nav__link">
    <span class="md-ellipsis">
      
        HybridRecommender
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HybridRecommender">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hybridrecommenderfit" class="md-nav__link">
    <span class="md-ellipsis">
      
        HybridRecommender.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybridrecommenderrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        HybridRecommender.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmf" class="md-nav__link">
    <span class="md-ellipsis">
      
        NMF
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NMF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nmffit" class="md-nav__link">
    <span class="md-ellipsis">
      
        NMF.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmfrecommend_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        NMF.recommend_items
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analytics-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analytics &amp; Utilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analytics &amp; Utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#score_potential" class="md-nav__link">
    <span class="md-ellipsis">
      
        score_potential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similar_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        similar_items
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_substitutes" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_substitutes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customer_saturation" class="md-nav__link">
    <span class="md-ellipsis">
      
        customer_saturation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export_item_factors" class="md-nav__link">
    <span class="md-ellipsis">
      
        export_item_factors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pca_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCA
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PCA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pcafit" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCA.fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcafit_transform" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCA.fit_transform
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcatransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCA.transform
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipelinerecommend" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline.recommend
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipelinerecommend_batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline.recommend_batch
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization-rusketviz" class="md-nav__link">
    <span class="md-ellipsis">
      
        Visualization (rusket.viz)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualization (rusket.viz)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rusketvizto_networkx" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.viz.to_networkx
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#distributed-spark-api-rusketspark" class="md-nav__link">
    <span class="md-ellipsis">
      
        Distributed Spark API (rusket.spark)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Distributed Spark API (rusket.spark)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rusketsparkmine_grouped" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.mine_grouped
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusketsparkrules_grouped" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.rules_grouped
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusketsparkprefixspan_grouped" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.prefixspan_grouped
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusketsparkhupm_grouped" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.hupm_grouped
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusketsparkrecommend_batches" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.recommend_batches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusketsparkto_spark" class="md-nav__link">
    <span class="md-ellipsis">
      
        rusket.spark.to_spark
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  

<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<blockquote>
<p>This file is <strong>auto-generated</strong> by <code>scripts/gen_api_reference.py</code>.  Do not edit by hand — update the Python docstrings instead.</p>
</blockquote>
<h2 id="functional-api">Functional API<a class="headerlink" href="#functional-api" title="Permanent link">&para;</a></h2>
<p>Convenience module-level functions.  For most use-cases these are the only entry points you need.</p>
<h3 id="mine"><code>mine</code><a class="headerlink" href="#mine" title="Permanent link">&para;</a></h3>
<p>Mine frequent itemsets using the optimal algorithm.</p>
<p>This module-level function relies on the Object-Oriented APIs.
Automatically selects between FP-Growth and Eclat based on density,
or falls back to FPMiner (streaming) if memory is low.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.mine</span><span class="w"> </span><span class="kn">import</span> <span class="n">mine</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">mine</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | pl.DataFrame | np.ndarray | Any&#39;</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">null_values</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">use_colnames</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">column_names</span><span class="p">:</span> <span class="s1">&#39;list[str] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="fpgrowth"><code>fpgrowth</code><a class="headerlink" href="#fpgrowth" title="Permanent link">&para;</a></h3>
<p>Find frequent itemsets using the optimal algorithm (Eclat or FP-growth).</p>
<p>This module-level function relies on the Object-Oriented APIs.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fpgrowth</span><span class="w"> </span><span class="kn">import</span> <span class="n">fpgrowth</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">fpgrowth</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | pl.DataFrame | np.ndarray | Any&#39;</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">null_values</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">use_colnames</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">column_names</span><span class="p">:</span> <span class="s1">&#39;list[str] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="eclat"><code>eclat</code><a class="headerlink" href="#eclat" title="Permanent link">&para;</a></h3>
<p>Find frequent itemsets using the Eclat algorithm.</p>
<p>This module-level function relies on the Object-Oriented APIs.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.eclat</span><span class="w"> </span><span class="kn">import</span> <span class="n">eclat</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">eclat</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | pl.DataFrame | np.ndarray | Any&#39;</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">null_values</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">use_colnames</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">column_names</span><span class="p">:</span> <span class="s1">&#39;list[str] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="association_rules"><code>association_rules</code><a class="headerlink" href="#association_rules" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.association_rules</span><span class="w"> </span><span class="kn">import</span> <span class="n">association_rules</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">association_rules</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | Any&#39;</span><span class="p">,</span> <span class="n">num_itemsets</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">df_orig</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">null_values</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">metric</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;confidence&#39;</span><span class="p">,</span> <span class="n">min_threshold</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">support_only</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_metrics</span><span class="p">:</span> <span class="s1">&#39;list[str]&#39;</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;antecedent support&#39;</span><span class="p">,</span> <span class="s1">&#39;consequent support&#39;</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="p">,</span> <span class="s1">&#39;confidence&#39;</span><span class="p">,</span> <span class="s1">&#39;lift&#39;</span><span class="p">,</span> <span class="s1">&#39;representativity&#39;</span><span class="p">,</span> <span class="s1">&#39;leverage&#39;</span><span class="p">,</span> <span class="s1">&#39;conviction&#39;</span><span class="p">,</span> <span class="s1">&#39;zhangs_metric&#39;</span><span class="p">,</span> <span class="s1">&#39;jaccard&#39;</span><span class="p">,</span> <span class="s1">&#39;certainty&#39;</span><span class="p">,</span> <span class="s1">&#39;kulczynski&#39;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="prefixspan"><code>prefixspan</code><a class="headerlink" href="#prefixspan" title="Permanent link">&para;</a></h3>
<p>Mine sequential patterns using the PrefixSpan algorithm.</p>
<p>This function discovers frequent sequences of items across multiple users/sessions.
Currently, this assumes sequences where each event consists of a single item
(e.g., a sequence of page views or a sequence of individual products bought over time).</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.prefixspan</span><span class="w"> </span><span class="kn">import</span> <span class="n">prefixspan</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">prefixspan</span><span class="p">(</span><span class="n">sequences</span><span class="p">:</span> <span class="s1">&#39;list[list[int]]&#39;</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;int | float&#39;</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>sequences</td>
<td>list of list of int</td>
<td>A list of sequences, where each sequence is a list of integers representing items. Example: <code>[[1, 2, 3], [1, 3], [2, 3]]</code>.</td>
</tr>
<tr>
<td>min_support</td>
<td>int | float</td>
<td>The minimum absolute support (number of sequences a pattern must appear in), or float percent.</td>
</tr>
<tr>
<td>max_len</td>
<td>int, optional</td>
<td>The maximum length of the sequential patterns to mine.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pd.DataFrame</td>
<td></td>
<td>A DataFrame containing 'support' and 'sequence' columns.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="hupm"><code>hupm</code><a class="headerlink" href="#hupm" title="Permanent link">&para;</a></h3>
<p>Mine high-utility itemsets.</p>
<p>This function discovers combinations of items that generate a high total utility
(e.g., profit) across all transactions, even if they aren't the most frequent.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.hupm</span><span class="w"> </span><span class="kn">import</span> <span class="n">hupm</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">hupm</span><span class="p">(</span><span class="n">transactions</span><span class="p">:</span> <span class="s1">&#39;list[list[int]]&#39;</span><span class="p">,</span> <span class="n">utilities</span><span class="p">:</span> <span class="s1">&#39;list[list[float]]&#39;</span><span class="p">,</span> <span class="n">min_utility</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>transactions</td>
<td>list of list of int</td>
<td>A list of transactions, where each transaction is a list of item IDs.</td>
</tr>
<tr>
<td>utilities</td>
<td>list of list of float</td>
<td>A list of identical structure to <code>transactions</code>, but containing the numeric utility (e.g., profit) of that item in that specific transaction.</td>
</tr>
<tr>
<td>min_utility</td>
<td>float</td>
<td>The minimum total utility required to consider a pattern "high-utility".</td>
</tr>
<tr>
<td>max_len</td>
<td>int, optional</td>
<td>The maximum length of the itemsets to mine.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pd.DataFrame</td>
<td></td>
<td>A DataFrame containing 'utility' and 'itemset' columns.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="sequences_from_event_log"><code>sequences_from_event_log</code><a class="headerlink" href="#sequences_from_event_log" title="Permanent link">&para;</a></h3>
<p>Convert an event log DataFrame into the sequence format required by PrefixSpan.</p>
<p>Accepts Pandas, Polars, or PySpark DataFrames. Data is grouped by <code>user_col</code>,
ordered by <code>time_col</code>, and <code>item_col</code> values are collected into sequences.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.prefixspan</span><span class="w"> </span><span class="kn">import</span> <span class="n">sequences_from_event_log</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">sequences_from_event_log</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">user_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">time_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[list[list[int]], dict[int, Any]]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>df</td>
<td>pd.DataFrame | pl.DataFrame | pyspark.sql.DataFrame</td>
<td>Event log containing users, timestamps, and items.</td>
</tr>
<tr>
<td>user_col</td>
<td>str</td>
<td>Column name identifying the sequence (e.g., user_id or session_id).</td>
</tr>
<tr>
<td>time_col</td>
<td>str</td>
<td>Column name for ordering events.</td>
</tr>
<tr>
<td>item_col</td>
<td>str</td>
<td>Column name for the items.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple of (indptr, indices, item_mapping)</td>
<td></td>
<td>- indptr: CSR-style index pointer list. - indices: Flattened item index list. - item_mapping: A dictionary mapping the integer IDs back to the original item labels.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="mine_hupm"><code>mine_hupm</code><a class="headerlink" href="#mine_hupm" title="Permanent link">&para;</a></h3>
<p>Mine high-utility itemsets from a long-format DataFrame.</p>
<p>Converts a Pandas or Polars DataFrame into the required list-of-lists format
and runs the High-Utility Pattern Mining (HUPM) algorithm.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.hupm</span><span class="w"> </span><span class="kn">import</span> <span class="n">mine_hupm</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">mine_hupm</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">transaction_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">utility_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">min_utility</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>pd.DataFrame or pl.DataFrame</td>
<td>A long-format DataFrame where each row represents an item in a transaction.</td>
</tr>
<tr>
<td>transaction_col</td>
<td>str</td>
<td>Column name identifying the transaction ID.</td>
</tr>
<tr>
<td>item_col</td>
<td>str</td>
<td>Column name identifying the item ID (must be numeric integers).</td>
</tr>
<tr>
<td>utility_col</td>
<td>str</td>
<td>Column name identifying the numeric utility (e.g. price, profit) of the item.</td>
</tr>
<tr>
<td>min_utility</td>
<td>float</td>
<td>The minimum total utility required to consider a pattern "high-utility".</td>
</tr>
<tr>
<td>max_len</td>
<td>int, optional</td>
<td>Maximum length of the itemsets to mine.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pd.DataFrame</td>
<td></td>
<td>A DataFrame containing 'utility' and 'itemset' columns.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="mine_duckdb"><code>mine_duckdb</code><a class="headerlink" href="#mine_duckdb" title="Permanent link">&para;</a></h3>
<p>Stream directly from a DuckDB query via Arrow RecordBatches.</p>
<p>This is extremely memory efficient, bypassing Pandas entirely.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.streaming</span><span class="w"> </span><span class="kn">import</span> <span class="n">mine_duckdb</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">mine_duckdb</span><span class="p">(</span><span class="n">con</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">n_items</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">txn_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">1000000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="mine_spark"><code>mine_spark</code><a class="headerlink" href="#mine_spark" title="Permanent link">&para;</a></h3>
<p>Stream natively from a PySpark DataFrame on Databricks via Arrow.</p>
<p>Uses <code>toLocalIterator()</code> to fetch Arrow chunks incrementally directly
to the driver node, avoiding massive memory spikes.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.streaming</span><span class="w"> </span><span class="kn">import</span> <span class="n">mine_spark</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">mine_spark</span><span class="p">(</span><span class="n">spark_df</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">n_items</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">txn_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="from_transactions"><code>from_transactions</code><a class="headerlink" href="#from_transactions" title="Permanent link">&para;</a></h3>
<p>Convert long-format transactional data to a one-hot boolean matrix.</p>
<p>The return type mirrors the input type:</p>
<ul>
<li><strong>Polars</strong> <code>DataFrame</code> → <strong>Polars</strong> <code>DataFrame</code></li>
<li><strong>Pandas</strong> <code>DataFrame</code> → <strong>Pandas</strong> <code>DataFrame</code></li>
<li><strong>Spark</strong> <code>DataFrame</code>  → <strong>Spark</strong>  <code>DataFrame</code></li>
<li><code>list[list[...]]</code>      → <strong>Pandas</strong> <code>DataFrame</code></li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.transactions</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_transactions</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">from_transactions</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s1">&#39;DataFrame | Sequence[Sequence[str | int]] | Any&#39;</span><span class="p">,</span> <span class="n">transaction_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">min_item_count</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td></td>
<td>One of:  - <strong>Pandas / Polars / Spark DataFrame</strong> with (at least) two columns: one for the transaction identifier and one for the item. - <strong>List of lists</strong> where each inner list contains the items of a single transaction, e.g. <code>[["bread", "milk"], ["bread", "eggs"]]</code>.</td>
</tr>
<tr>
<td>transaction_col</td>
<td></td>
<td>Name of the column that identifies transactions.  If <code>None</code> the first column is used.  Ignored for list-of-lists input.</td>
</tr>
<tr>
<td>item_col</td>
<td></td>
<td>Name of the column that contains item values.  If <code>None</code> the second column is used.  Ignored for list-of-lists input.</td>
</tr>
<tr>
<td>min_item_count</td>
<td></td>
<td>Minimum number of times an item must appear to be included in the resulting one-hot-encoded matrix. Default is 1.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DataFrame</td>
<td></td>
<td>A boolean DataFrame (same type as input) ready for :func:<code>rusket.fpgrowth</code> or :func:<code>rusket.eclat</code>. Column names correspond to the unique items.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">rusket</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="o">...</span>     <span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="o">...</span>     <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="o">...</span> <span class="p">})</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">ohe</span> <span class="o">=</span> <span class="n">rusket</span><span class="o">.</span><span class="n">from_transactions</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">rusket</span><span class="o">.</span><span class="n">fpgrowth</span><span class="p">(</span><span class="n">ohe</span><span class="p">,</span> <span class="n">min_support</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_colnames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h3 id="from_transactions_csr"><code>from_transactions_csr</code><a class="headerlink" href="#from_transactions_csr" title="Permanent link">&para;</a></h3>
<p>Convert long-format transactional data to a CSR matrix + column names.</p>
<p>Unlike :func:<code>from_transactions</code>, this returns a raw
<code>scipy.sparse.csr_matrix</code> that can be passed directly to
:func:<code>rusket.fpgrowth</code> or :func:<code>rusket.eclat</code> — <strong>no pandas overhead</strong>.</p>
<p>For billion-row datasets, this processes data in chunks of <code>chunk_size</code>
rows, keeping peak memory to one chunk + the running CSR.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.transactions</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_transactions_csr</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">from_transactions_csr</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s1">&#39;DataFrame | str | Any&#39;</span><span class="p">,</span> <span class="n">transaction_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10000000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[Any, list[str]]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td></td>
<td>One of:  - <strong>Pandas DataFrame</strong> with (at least) two columns. - <strong>Polars DataFrame</strong> or <strong>Spark DataFrame</strong> (converted internally). - <strong>File path</strong> (str / Path) to a Parquet file — read in chunks.</td>
</tr>
<tr>
<td>transaction_col</td>
<td></td>
<td>Name of the transaction-id column. Defaults to the first column.</td>
</tr>
<tr>
<td>item_col</td>
<td></td>
<td>Name of the item column. Defaults to the second column.</td>
</tr>
<tr>
<td>chunk_size</td>
<td></td>
<td>Number of rows per chunk. Lower values use less memory. Default: 10 million rows.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[scipy.sparse.csr_matrix, list[str]]</td>
<td></td>
<td>A CSR matrix and the list of column (item) names.  Pass directly::  csr, names = from_transactions_csr(df) freq = fpgrowth(csr, min_support=0.001, use_colnames=True, column_names=names)</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">rusket</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">csr</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="n">rusket</span><span class="o">.</span><span class="n">from_transactions_csr</span><span class="p">(</span><span class="s2">&quot;orders.parquet&quot;</span><span class="p">)</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">rusket</span><span class="o">.</span><span class="n">fpgrowth</span><span class="p">(</span><span class="n">csr</span><span class="p">,</span> <span class="n">min_support</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="o">...</span>                        <span class="n">use_colnames</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h3 id="from_pandas"><code>from_pandas</code><a class="headerlink" href="#from_pandas" title="Permanent link">&para;</a></h3>
<p>Shorthand for <code>from_transactions(df, transaction_col, item_col)</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.transactions</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_pandas</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame&#39;</span><span class="p">,</span> <span class="n">transaction_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">min_item_count</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="from_polars"><code>from_polars</code><a class="headerlink" href="#from_polars" title="Permanent link">&para;</a></h3>
<p>Shorthand for <code>from_transactions(df, transaction_col, item_col)</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.transactions</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_polars</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">from_polars</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;pl.DataFrame&#39;</span><span class="p">,</span> <span class="n">transaction_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">min_item_count</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pl.DataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="from_spark"><code>from_spark</code><a class="headerlink" href="#from_spark" title="Permanent link">&para;</a></h3>
<p>Shorthand for <code>from_transactions(df, transaction_col, item_col)</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.transactions</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_spark</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">from_spark</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;SparkDataFrame&#39;</span><span class="p">,</span> <span class="n">transaction_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">min_item_count</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;SparkDataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="from_arrow"><code>from_arrow</code><a class="headerlink" href="#from_arrow" title="Permanent link">&para;</a></h3>
<p>Convert a PyArrow Table in long format to a one-hot boolean PyArrow Table.</p>
<p>This is a zero-copy-friendly shorthand for <code>from_transactions(table, ...)</code>.  The
input table must have at least two columns: one for the transaction identifier and
one for the item.  The returned table has boolean columns (one per unique item).</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.transactions</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_arrow</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="n">from_arrow</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="s1">&#39;pa.Table&#39;</span><span class="p">,</span> <span class="n">transaction_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">min_item_count</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pa.Table&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>table</td>
<td></td>
<td>A <code>pyarrow.Table</code> with at least two columns (transaction id + item).</td>
</tr>
<tr>
<td>transaction_col</td>
<td></td>
<td>Name of the transaction-id column. Defaults to the first column.</td>
</tr>
<tr>
<td>item_col</td>
<td></td>
<td>Name of the item column. Defaults to the second column.</td>
</tr>
<tr>
<td>min_item_count</td>
<td></td>
<td>Minimum occurrences for an item to be included. Default is 1.</td>
</tr>
<tr>
<td>verbose</td>
<td></td>
<td>Verbosity level.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pyarrow.Table</td>
<td></td>
<td>A boolean Table ready for :func:<code>rusket.fpgrowth</code> / :func:<code>rusket.eclat</code>.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="evaluate"><code>evaluate</code><a class="headerlink" href="#evaluate" title="Permanent link">&para;</a></h3>
<p>Evaluate a trained recommendation model on a test set.</p>
<p>Compute metrics like NDCG@k, Hit Rate@k, Precision@k, and Recall@k using
fast natively-backed Rust evaluation loops.</p>
<p>When a model has <code>_user_labels</code> / <code>_item_labels</code> (set by
<code>from_transactions()</code>), the test IDs are automatically mapped to
internal 0-based indices so that <code>recommend_items()</code> receives valid
indices and the recommended item indices can be compared with the
ground truth.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.evaluation</span><span class="w"> </span><span class="kn">import</span> <span class="n">evaluate</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="n">evaluate</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">test_interactions</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">metrics</span><span class="p">:</span> <span class="s1">&#39;list[MetricName] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;dict[str, float]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>model</td>
<td>Any</td>
<td>A trained recommendation model supporting <code>recommend_items(user_id, k, exclude_seen)</code>.</td>
</tr>
<tr>
<td>test_interactions</td>
<td>np.ndarray or pd.DataFrame</td>
<td>Ground truth test interactions. Must either have columns "user" and "item", or be a 2D array format.</td>
</tr>
<tr>
<td>k</td>
<td>int, default=10</td>
<td>The cutoff rank for evaluation.</td>
</tr>
<tr>
<td>metrics</td>
<td>list of str, optional</td>
<td>Metrics to compute. Default: ["ndcg", "hr", "precision", "recall"].</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dict[str, float]</td>
<td></td>
<td>Dictionary of averaged metric values.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="train_test_split"><code>train_test_split</code><a class="headerlink" href="#train_test_split" title="Permanent link">&para;</a></h3>
<p>Split interactions into random train and test sets.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">user_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">test_size</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>df</td>
<td>pd.DataFrame</td>
<td>The interaction dataframe.</td>
</tr>
<tr>
<td>user_col</td>
<td>str</td>
<td>Name of the user column.</td>
</tr>
<tr>
<td>item_col</td>
<td>str</td>
<td>Name of the item column.</td>
</tr>
<tr>
<td>test_size</td>
<td>float, default=0.2</td>
<td>Percentage of data to put in the test set.</td>
</tr>
<tr>
<td>random_state</td>
<td>int, optional</td>
<td>Set random seed (currently not used by Rust backend, but reserved for future).</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[pd.DataFrame, pd.DataFrame]</td>
<td></td>
<td>train_df, test_df</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="leave_one_out_split"><code>leave_one_out_split</code><a class="headerlink" href="#leave_one_out_split" title="Permanent link">&para;</a></h3>
<p>Leave exactly one interaction per user for the test set.</p>
<p>If a timestamp column is provided, the latest interaction is left out.
If no timestamp is provided, a random interaction is chosen.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">leave_one_out_split</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">leave_one_out_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">user_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">timestamp_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>df</td>
<td>pd.DataFrame</td>
<td>The interaction dataframe.</td>
</tr>
<tr>
<td>user_col</td>
<td>str</td>
<td>Name of the user column (must be numeric encoded to i32 ideally, or pandas int).</td>
</tr>
<tr>
<td>item_col</td>
<td>str</td>
<td>Name of the item column.</td>
</tr>
<tr>
<td>timestamp_col</td>
<td>str, optional</td>
<td>Name of the timestamp or ordering column.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[pd.DataFrame, pd.DataFrame]</td>
<td></td>
<td>train_df, test_df</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="pca"><code>pca</code><a class="headerlink" href="#pca" title="Permanent link">&para;</a></h3>
<p>Project data into <code>n_components</code> dimensions using PCA.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.pca</span><span class="w"> </span><span class="kn">import</span> <span class="n">pca</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="n">pca</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="s1">&#39;npt.NDArray[Any]&#39;</span><span class="p">,</span> <span class="n">n_components</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">svd_solver</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ProjectedSpace&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>x</td>
<td>array-like of shape (n_samples, n_features)</td>
<td></td>
</tr>
<tr>
<td>n_components</td>
<td>int, default=2</td>
<td></td>
</tr>
<tr>
<td>svd_solver</td>
<td>{"auto", "exact", "randomized"}, default="auto"</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="pca2"><code>pca2</code><a class="headerlink" href="#pca2" title="Permanent link">&para;</a></h3>
<p>Project data into exactly 2 dimensions using PCA.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.pca</span><span class="w"> </span><span class="kn">import</span> <span class="n">pca2</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">pca2</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="s1">&#39;npt.NDArray[Any]&#39;</span><span class="p">,</span> <span class="n">svd_solver</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ProjectedSpace&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="pca3"><code>pca3</code><a class="headerlink" href="#pca3" title="Permanent link">&para;</a></h3>
<p>Project data into exactly 3 dimensions using PCA.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.pca</span><span class="w"> </span><span class="kn">import</span> <span class="n">pca3</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="n">pca3</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="s1">&#39;npt.NDArray[Any]&#39;</span><span class="p">,</span> <span class="n">svd_solver</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ProjectedSpace&#39;</span>
</span></code></pre></div>
<hr />
<h2 id="oop-mining-api">OOP Mining API<a class="headerlink" href="#oop-mining-api" title="Permanent link">&para;</a></h2>
<p>All mining classes share a common <code>Miner.from_transactions()</code> / <code>.mine()</code> interface. <code>FPGrowth</code>, <code>Eclat</code>, <code>AutoMiner</code>, and <code>HUPM</code> also inherit <code>RuleMinerMixin</code> which adds <code>.association_rules()</code> and <code>.recommend_items()</code> helpers.</p>
<h3 id="fpgrowth_1"><code>FPGrowth</code><a class="headerlink" href="#fpgrowth_1" title="Permanent link">&para;</a></h3>
<p>FP-Growth frequent itemset miner.</p>
<p>This class wraps the fast, core Rust FP-Growth implementation.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fpgrowth</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPGrowth</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="n">FPGrowth</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | pl.DataFrame | np.ndarray | Any&#39;</span><span class="p">,</span> <span class="n">item_names</span><span class="p">:</span> <span class="s1">&#39;list[str] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">null_values</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">use_colnames</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="fpgrowthmine"><code>FPGrowth.mine</code><a class="headerlink" href="#fpgrowthmine" title="Permanent link">&para;</a></h4>
<p>Execute the FP-growth algorithm on the stored data.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fpgrowth</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPGrowth</span><span class="o">.</span><span class="n">mine</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="n">FPGrowth</span><span class="o">.</span><span class="n">mine</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pandas.DataFrame</td>
<td></td>
<td>DataFrame with two columns: - <code>support</code>: the support score. - <code>itemsets</code>: list of items (indices or column names).</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="eclat_1"><code>Eclat</code><a class="headerlink" href="#eclat_1" title="Permanent link">&para;</a></h3>
<p>Eclat frequent itemset miner.</p>
<p>Eclat is typically faster than FP-growth on dense datasets due to
efficient vertical bitset intersection logic.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.eclat</span><span class="w"> </span><span class="kn">import</span> <span class="n">Eclat</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="n">Eclat</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | pl.DataFrame | np.ndarray | Any&#39;</span><span class="p">,</span> <span class="n">item_names</span><span class="p">:</span> <span class="s1">&#39;list[str] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">null_values</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">use_colnames</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="eclatmine"><code>Eclat.mine</code><a class="headerlink" href="#eclatmine" title="Permanent link">&para;</a></h4>
<p>Execute the Eclat algorithm on the stored data.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.eclat</span><span class="w"> </span><span class="kn">import</span> <span class="n">Eclat</span><span class="o">.</span><span class="n">mine</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="n">Eclat</span><span class="o">.</span><span class="n">mine</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pandas.DataFrame</td>
<td></td>
<td>DataFrame with two columns: - <code>support</code>: the support score. - <code>itemsets</code>: list of items (indices or column names).</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="autominer"><code>AutoMiner</code><a class="headerlink" href="#autominer" title="Permanent link">&para;</a></h3>
<p>Automatic frequent itemset miner.</p>
<p>Selects the optimal miner (FP-Growth or Eclat) based on matrix density.
Automatically falls back to streaming (FPMiner) if the dataset exceeds
available memory.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.mine</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoMiner</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="n">AutoMiner</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | pl.DataFrame | np.ndarray | Any&#39;</span><span class="p">,</span> <span class="n">item_names</span><span class="p">:</span> <span class="s1">&#39;list[str] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">null_values</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">use_colnames</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="autominermine"><code>AutoMiner.mine</code><a class="headerlink" href="#autominermine" title="Permanent link">&para;</a></h4>
<p>Execute the optimal algorithm on the stored data.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.mine</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoMiner</span><span class="o">.</span><span class="n">mine</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="n">AutoMiner</span><span class="o">.</span><span class="n">mine</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pandas.DataFrame</td>
<td></td>
<td>DataFrame with two columns: - <code>support</code>: the support score. - <code>itemsets</code>: list of items (indices or column names).</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="prefixspan_1"><code>PrefixSpan</code><a class="headerlink" href="#prefixspan_1" title="Permanent link">&para;</a></h3>
<p>Sequential Pattern Mining (PrefixSpan) model.</p>
<p>This class discovers frequent sequences of items across multiple users/sessions.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.prefixspan</span><span class="w"> </span><span class="kn">import</span> <span class="n">PrefixSpan</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="n">PrefixSpan</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s1">&#39;list[list[int]]&#39;</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;int | float&#39;</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item_mapping</span><span class="p">:</span> <span class="s1">&#39;dict[int, Any] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="prefixspanmine"><code>PrefixSpan.mine</code><a class="headerlink" href="#prefixspanmine" title="Permanent link">&para;</a></h4>
<p>Mine sequential patterns using PrefixSpan.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.prefixspan</span><span class="w"> </span><span class="kn">import</span> <span class="n">PrefixSpan</span><span class="o">.</span><span class="n">mine</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="n">PrefixSpan</span><span class="o">.</span><span class="n">mine</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pd.DataFrame</td>
<td></td>
<td>A DataFrame containing 'support' and 'sequence' columns. Sequences are mapped back to original item names if <code>from_transactions</code> was used.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="hupm_1"><code>HUPM</code><a class="headerlink" href="#hupm_1" title="Permanent link">&para;</a></h3>
<p>High-Utility Pattern Mining (HUPM) model.</p>
<p>This class discovers combinations of items that generate a high total utility
(e.g., profit) across all transactions, even if they aren't the most frequent.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.hupm</span><span class="w"> </span><span class="kn">import</span> <span class="n">HUPM</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="n">HUPM</span><span class="p">(</span><span class="n">transactions</span><span class="p">:</span> <span class="s1">&#39;list[list[int]]&#39;</span><span class="p">,</span> <span class="n">utilities</span><span class="p">:</span> <span class="s1">&#39;list[list[float]]&#39;</span><span class="p">,</span> <span class="n">min_utility</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="hupmmine"><code>HUPM.mine</code><a class="headerlink" href="#hupmmine" title="Permanent link">&para;</a></h4>
<p>Mine high-utility itemsets.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.hupm</span><span class="w"> </span><span class="kn">import</span> <span class="n">HUPM</span><span class="o">.</span><span class="n">mine</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="n">HUPM</span><span class="o">.</span><span class="n">mine</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pd.DataFrame</td>
<td></td>
<td>A DataFrame containing 'utility' and 'itemset' columns.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="fpminer"><code>FPMiner</code><a class="headerlink" href="#fpminer" title="Permanent link">&para;</a></h3>
<p>Streaming FP-Growth / Eclat accumulator for billion-row datasets.</p>
<p>Feeds (transaction_id, item_id) integer arrays to Rust one chunk at a
time.  Rust accumulates per-transaction item lists in a
<code>HashMap&lt;i64, Vec&lt;i32&gt;&gt;</code>.  Peak <strong>Python</strong> memory = one chunk.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.streaming</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMiner</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="n">FPMiner</span><span class="p">(</span><span class="n">n_items</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">max_ram_mb</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">hint_n_transactions</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>n_items</td>
<td>int</td>
<td>Number of distinct items (column count).  All item IDs fed via :meth:<code>add_chunk</code> must be in <code>[0, n_items)</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="n">Process</span> <span class="n">a</span> <span class="n">Parquet</span> <span class="n">file</span> <span class="mi">10</span> <span class="n">M</span> <span class="n">rows</span> <span class="n">at</span> <span class="n">a</span> <span class="n">time</span><span class="p">:</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">rusket</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMiner</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">miner</span> <span class="o">=</span> <span class="n">FPMiner</span><span class="p">(</span><span class="n">n_items</span><span class="o">=</span><span class="mi">500_000</span><span class="p">)</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;orders.parquet&quot;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">10_000_000</span><span class="p">):</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="o">...</span>     <span class="n">txn</span> <span class="o">=</span> <span class="n">chunk</span><span class="p">[</span><span class="s2">&quot;txn_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int64&quot;</span><span class="p">)</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="o">...</span>     <span class="n">item</span> <span class="o">=</span> <span class="n">chunk</span><span class="p">[</span><span class="s2">&quot;item_idx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="o">...</span>     <span class="n">miner</span><span class="o">.</span><span class="n">add_chunk</span><span class="p">(</span><span class="n">txn</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">miner</span><span class="o">.</span><span class="n">mine</span><span class="p">(</span><span class="n">min_support</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">use_colnames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="fpmineradd_arrow_batch"><code>FPMiner.add_arrow_batch</code><a class="headerlink" href="#fpmineradd_arrow_batch" title="Permanent link">&para;</a></h4>
<p>Feed a PyArrow RecordBatch directly into the miner.
Zero-copy extraction is used if types match (Int64/Int32).</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.streaming</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMiner</span><span class="o">.</span><span class="n">add_arrow_batch</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="n">FPMiner</span><span class="o">.</span><span class="n">add_arrow_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">txn_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;FPMiner&#39;</span>
</span></code></pre></div>
<hr />
<h4 id="fpmineradd_chunk"><code>FPMiner.add_chunk</code><a class="headerlink" href="#fpmineradd_chunk" title="Permanent link">&para;</a></h4>
<p>Feed a chunk of (transaction_id, item_id) pairs.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.streaming</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMiner</span><span class="o">.</span><span class="n">add_chunk</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="n">FPMiner</span><span class="o">.</span><span class="n">add_chunk</span><span class="p">(</span><span class="n">txn_ids</span><span class="p">:</span> <span class="s1">&#39;np.ndarray&#39;</span><span class="p">,</span> <span class="n">item_ids</span><span class="p">:</span> <span class="s1">&#39;np.ndarray&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;FPMiner&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>txn_ids</td>
<td>np.ndarray[int64]</td>
<td>1-D array of transaction identifiers (arbitrary 64-bit integers).</td>
</tr>
<tr>
<td>item_ids</td>
<td>np.ndarray[int32]</td>
<td>1-D array of item column indices (0-based).</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>self  (for chaining)</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="fpminerfit"><code>FPMiner.fit</code><a class="headerlink" href="#fpminerfit" title="Permanent link">&para;</a></h4>
<p>Sklearn-compatible alias for <code>mine()</code>. Runs the mining algorithm.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.streaming</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMiner</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="n">FPMiner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;FPMiner&#39;</span>
</span></code></pre></div>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>self</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="fpminermine"><code>FPMiner.mine</code><a class="headerlink" href="#fpminermine" title="Permanent link">&para;</a></h4>
<p>Mine frequent itemsets from all accumulated transactions.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.streaming</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMiner</span><span class="o">.</span><span class="n">mine</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="n">FPMiner</span><span class="o">.</span><span class="n">mine</span><span class="p">(</span><span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">use_colnames</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">column_names</span><span class="p">:</span> <span class="s1">&#39;list[str] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="s2">&quot;typing.Literal[&#39;fpgrowth&#39;, &#39;eclat&#39;, &#39;auto&#39;]&quot;</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>min_support</td>
<td>float</td>
<td>Minimum support threshold in <code>(0, 1]</code>.</td>
</tr>
<tr>
<td>max_len</td>
<td>int | None</td>
<td>Maximum itemset length.</td>
</tr>
<tr>
<td>use_colnames</td>
<td>bool</td>
<td>If <code>True</code>, itemsets contain column names instead of indices.</td>
</tr>
<tr>
<td>column_names</td>
<td>list[str] | None</td>
<td>Column names to use when <code>use_colnames=True</code>.</td>
</tr>
<tr>
<td>method</td>
<td>"fpgrowth" | "eclat" | "auto"</td>
<td>Mining algorithm to use.  <code>"auto"</code> (default) picks the best algorithm automatically based on data density after pre-filtering rare items (Borgelt 2003 heuristic: density &lt; 15% → Eclat, else FPGrowth).</td>
</tr>
<tr>
<td>verbose</td>
<td>int</td>
<td>Level of verbosity: &gt;0 prints progress logs and times.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pd.DataFrame</td>
<td></td>
<td>Columns <code>support</code> and <code>itemsets</code>.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="fpminerpredict"><code>FPMiner.predict</code><a class="headerlink" href="#fpminerpredict" title="Permanent link">&para;</a></h4>
<p>Return the last mined result, or run <code>fit()</code> first.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.streaming</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMiner</span><span class="o">.</span><span class="n">predict</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="n">FPMiner</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pd.DataFrame</td>
<td></td>
<td>The frequent itemsets.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="fpminerreset"><code>FPMiner.reset</code><a class="headerlink" href="#fpminerreset" title="Permanent link">&para;</a></h4>
<p>Free all accumulated data.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.streaming</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMiner</span><span class="o">.</span><span class="n">reset</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="n">FPMiner</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<hr />
<hr />
<h3 id="fin"><code>FIN</code><a class="headerlink" href="#fin" title="Permanent link">&para;</a></h3>
<p>FIN (Fast Itemset per Nodeset) frequent itemset miner.</p>
<p>This class wraps the fast core Rust FIN implementation.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fin</span><span class="w"> </span><span class="kn">import</span> <span class="n">FIN</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="n">FIN</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | pl.DataFrame | np.ndarray | Any&#39;</span><span class="p">,</span> <span class="n">item_names</span><span class="p">:</span> <span class="s1">&#39;list[str] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">null_values</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">use_colnames</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="finmine"><code>FIN.mine</code><a class="headerlink" href="#finmine" title="Permanent link">&para;</a></h4>
<p>Execute the FIN algorithm on the stored data.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fin</span><span class="w"> </span><span class="kn">import</span> <span class="n">FIN</span><span class="o">.</span><span class="n">mine</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="n">FIN</span><span class="o">.</span><span class="n">mine</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pandas.DataFrame</td>
<td></td>
<td>DataFrame with two columns: - <code>support</code>: the support score. - <code>itemsets</code>: list of items (indices or column names).</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="lcm"><code>LCM</code><a class="headerlink" href="#lcm" title="Permanent link">&para;</a></h3>
<p>LCM (Linear Closed Itemset Miner) frequent itemset miner.</p>
<p>This class wraps the fast core Rust LCM implementation using Prefix-Preserving Closure Extension.
It produces only <em>closed</em> frequent itemsets, offering massive memory savings
and faster execution out-of-the-box compared to classic algorithms on dense datasets.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.lcm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LCM</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="n">LCM</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | pl.DataFrame | np.ndarray | Any&#39;</span><span class="p">,</span> <span class="n">item_names</span><span class="p">:</span> <span class="s1">&#39;list[str] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">null_values</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">use_colnames</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="lcmmine"><code>LCM.mine</code><a class="headerlink" href="#lcmmine" title="Permanent link">&para;</a></h4>
<p>Execute the LCM algorithm on the stored data to find closed itemsets.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.lcm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LCM</span><span class="o">.</span><span class="n">mine</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="n">LCM</span><span class="o">.</span><span class="n">mine</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pandas.DataFrame</td>
<td></td>
<td>DataFrame with two columns: - <code>support</code>: the support score. - <code>itemsets</code>: list of items (indices or column names).</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h2 id="ruleminermixin-shared-miner-interface"><code>RuleMinerMixin</code> — Shared Miner Interface<a class="headerlink" href="#ruleminermixin-shared-miner-interface" title="Permanent link">&para;</a></h2>
<p><code>FPGrowth</code>, <code>Eclat</code>, <code>AutoMiner</code>, and <code>HUPM</code> all inherit these methods from <code>RuleMinerMixin</code>.  You do not construct <code>RuleMinerMixin</code> directly.</p>
<h3 id="ruleminermixinassociation_rules"><code>RuleMinerMixin.association_rules</code><a class="headerlink" href="#ruleminermixinassociation_rules" title="Permanent link">&para;</a></h3>
<p>Generate association rules from the mined frequent itemsets.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">RuleMinerMixin</span><span class="o">.</span><span class="n">association_rules</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="n">RuleMinerMixin</span><span class="o">.</span><span class="n">association_rules</span><span class="p">(</span><span class="n">metric</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;confidence&#39;</span><span class="p">,</span> <span class="n">min_threshold</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">return_metrics</span><span class="p">:</span> <span class="s1">&#39;list[str] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>metric</td>
<td>str, default='confidence'</td>
<td>The metric to evaluate if a rule is of interest.</td>
</tr>
<tr>
<td>min_threshold</td>
<td>float, default=0.8</td>
<td>The minimum threshold for the evaluation metric.</td>
</tr>
<tr>
<td>return_metrics</td>
<td>list[str] | None, default=None</td>
<td>List of metrics to include in the resulting DataFrame. Defaults to all available metrics.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pd.DataFrame</td>
<td></td>
<td>DataFrame of strong association rules.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="ruleminermixinrecommend_items"><code>RuleMinerMixin.recommend_items</code><a class="headerlink" href="#ruleminermixinrecommend_items" title="Permanent link">&para;</a></h3>
<p>Deprecated: use :meth:<code>recommend_for_cart</code> instead.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">RuleMinerMixin</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="n">RuleMinerMixin</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">items</span><span class="p">:</span> <span class="s1">&#39;list[Any]&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;list[Any]&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="ruleminermixin_invalidate_rules_cache"><code>RuleMinerMixin._invalidate_rules_cache</code><a class="headerlink" href="#ruleminermixin_invalidate_rules_cache" title="Permanent link">&para;</a></h3>
<p>Clear the cached association rules (call after re-mining).</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">RuleMinerMixin</span><span class="o">.</span><span class="n">_invalidate_rules_cache</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="n">RuleMinerMixin</span><span class="o">.</span><span class="n">_invalidate_rules_cache</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<hr />
<h2 id="recommenders">Recommenders<a class="headerlink" href="#recommenders" title="Permanent link">&para;</a></h2>
<h3 id="als"><code>ALS</code><a class="headerlink" href="#als" title="Permanent link">&para;</a></h3>
<p>Implicit ALS collaborative filtering model.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.als</span><span class="w"> </span><span class="kn">import</span> <span class="n">ALS</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="n">ALS</span><span class="p">(</span><span class="n">factors</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">regularization</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">40.0</span><span class="p">,</span> <span class="n">iterations</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cg_iters</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">use_cholesky</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">anderson_m</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>factors</td>
<td>int</td>
<td>Number of latent factors.</td>
</tr>
<tr>
<td>regularization</td>
<td>float</td>
<td>L2 regularisation weight.</td>
</tr>
<tr>
<td>alpha</td>
<td>float</td>
<td>Confidence scaling: <code>confidence = 1 + alpha * r</code>.</td>
</tr>
<tr>
<td>iterations</td>
<td>int</td>
<td>Number of ALS outer iterations.</td>
</tr>
<tr>
<td>seed</td>
<td>int</td>
<td>Random seed.</td>
</tr>
<tr>
<td>cg_iters</td>
<td>int</td>
<td>Conjugate Gradient iterations per user/item solve (ignored when <code>use_cholesky=True</code>).  Reduce to 3 for very large datasets.</td>
</tr>
<tr>
<td>use_cholesky</td>
<td>bool</td>
<td>Use a direct Cholesky solve instead of iterative CG. Exact solution; faster when users have many interactions relative to <code>factors</code>.</td>
</tr>
<tr>
<td>anderson_m</td>
<td>int</td>
<td>History window for <strong>Anderson Acceleration</strong> of the outer ALS loop (default 0 = disabled).  Recommended value: <strong>5</strong>.  ALS is a fixed-point iteration <code>(U,V) → F(U,V)</code>.  Anderson mixing extrapolates over the last <code>m</code> residuals to reach the fixed point faster, typically reducing the number of outer iterations by 30–50 % at identical recommendation quality::  # Baseline: 15 iterations model = ALS(iterations=15, cg_iters=3)  # Anderson-accelerated: 10 iterations, ~2.5× faster, same quality model = ALS(iterations=10, cg_iters=3, anderson_m=5)  Memory overhead: <code>m</code> copies of the full <code>(U ∥ V)</code> matrix (~57 MB per copy at 25M ratings, k=64).</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="n">Fold</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">new</span> <span class="n">user</span> <span class="n">without</span> <span class="n">retraining</span> <span class="n">the</span> <span class="n">entire</span> <span class="n">model</span> <span class="n">matrix</span><span class="p">:</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">rusket</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">csr_matrix</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Fit model on some data</span>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">rusket</span><span class="o">.</span><span class="n">ALS</span><span class="p">(</span><span class="n">factors</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))))</span>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># New user interacts with items 3, 5, and 12</span>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">latent_factors</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">recalculate_user</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># `latent_factors` is a 1D array of length `factors=8`</span>
</span></code></pre></div>
<h4 id="alsbatch_recommend"><code>ALS.batch_recommend</code><a class="headerlink" href="#alsbatch_recommend" title="Permanent link">&para;</a></h4>
<p>Top-N items for all users efficiently computed in parallel.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.als</span><span class="w"> </span><span class="kn">import</span> <span class="n">ALS</span><span class="o">.</span><span class="n">batch_recommend</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="n">ALS</span><span class="o">.</span><span class="n">batch_recommend</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;polars&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>n</td>
<td>int, default=10</td>
<td>The number of items to recommend per user.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool, default=True</td>
<td>Whether to exclude items the user has already interacted with.</td>
</tr>
<tr>
<td>format</td>
<td>str, default="polars"</td>
<td>The DataFrame format to return. One of "pandas", "polars", or "spark".</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DataFrame</td>
<td></td>
<td>A DataFrame with columns <code>user_id</code>, <code>item_id</code>, and <code>score</code>.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="alsfit"><code>ALS.fit</code><a class="headerlink" href="#alsfit" title="Permanent link">&para;</a></h4>
<p>Fit the model to the user-item interaction matrix.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.als</span><span class="w"> </span><span class="kn">import</span> <span class="n">ALS</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="n">ALS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">interactions</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ALS&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>interactions</td>
<td>sparse matrix or numpy array, optional</td>
<td>If None, uses the matrix prepared by <code>from_transactions()</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Raises</strong></p>
<table>
<thead>
<tr>
<th>Exception</th>
<th>Condition</th>
</tr>
</thead>
<tbody>
<tr>
<td>RuntimeError</td>
<td></td>
</tr>
<tr>
<td>TypeError</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="alsrecalculate_user"><code>ALS.recalculate_user</code><a class="headerlink" href="#alsrecalculate_user" title="Permanent link">&para;</a></h4>
<p>Calculate the latent factors for a new or existing user given their interacted items.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.als</span><span class="w"> </span><span class="kn">import</span> <span class="n">ALS</span><span class="o">.</span><span class="n">recalculate_user</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="n">ALS</span><span class="o">.</span><span class="n">recalculate_user</span><span class="p">(</span><span class="n">user_items</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;np.ndarray&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_items</td>
<td>list of int or 1D array-like</td>
<td>The item indices the user has interacted with. If the model was fitted using a DataFrame with item names, these should be the mapped item indices from 0 to n_items - 1.  Note: Confidence values for interactions are currently treated as 1.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ndarray</td>
<td></td>
<td>A 1D numpy array of shape (factors,) containing the user's latent factors.</td>
</tr>
</tbody>
</table>
<p><strong>Raises</strong></p>
<table>
<thead>
<tr>
<th>Exception</th>
<th>Condition</th>
</tr>
</thead>
<tbody>
<tr>
<td>RuntimeError</td>
<td></td>
</tr>
<tr>
<td>ValueError</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="alsrecommend_items"><code>ALS.recommend_items</code><a class="headerlink" href="#alsrecommend_items" title="Permanent link">&para;</a></h4>
<p>Top-N items for a user. Set exclude_seen=False to include already-seen items.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.als</span><span class="w"> </span><span class="kn">import</span> <span class="n">ALS</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="n">ALS</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[Any, Any]&#39;</span>
</span></code></pre></div>
<hr />
<h4 id="alsrecommend_users"><code>ALS.recommend_users</code><a class="headerlink" href="#alsrecommend_users" title="Permanent link">&para;</a></h4>
<p>Top-N users for an item.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.als</span><span class="w"> </span><span class="kn">import</span> <span class="n">ALS</span><span class="o">.</span><span class="n">recommend_users</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="n">ALS</span><span class="o">.</span><span class="n">recommend_users</span><span class="p">(</span><span class="n">item_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[Any, Any]&#39;</span>
</span></code></pre></div>
<hr />
<hr />
<h3 id="bpr"><code>BPR</code><a class="headerlink" href="#bpr" title="Permanent link">&para;</a></h3>
<p>Bayesian Personalized Ranking (BPR) model for implicit feedback.</p>
<p>BPR optimizes for ranking rather than reconstruction error (like ALS).
It works by drawing positive items the user interacted with, and negative items
they haven't, and adjusting latent factors to ensure the positive item scores higher.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.bpr</span><span class="w"> </span><span class="kn">import</span> <span class="n">BPR</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="n">BPR</span><span class="p">(</span><span class="n">factors</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">regularization</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">iterations</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>factors</td>
<td>int</td>
<td>Number of latent factors (default: 64).</td>
</tr>
<tr>
<td>learning_rate</td>
<td>float</td>
<td>SGD learning rate (default: 0.05).</td>
</tr>
<tr>
<td>regularization</td>
<td>float</td>
<td>L2 regularization weight (default: 0.01).</td>
</tr>
<tr>
<td>iterations</td>
<td>int</td>
<td>Number of passes over the entire interaction dataset (default: 150).</td>
</tr>
<tr>
<td>seed</td>
<td>int</td>
<td>Random seed for Hogwild! SGD sampling (default: 42).</td>
</tr>
</tbody>
</table>
<h4 id="bprfit"><code>BPR.fit</code><a class="headerlink" href="#bprfit" title="Permanent link">&para;</a></h4>
<p>Fit the BPR model to the user-item interaction matrix.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.bpr</span><span class="w"> </span><span class="kn">import</span> <span class="n">BPR</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="n">BPR</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">interactions</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BPR&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>interactions</td>
<td>sparse matrix or numpy array, optional</td>
<td>If None, uses the matrix prepared by <code>from_transactions()</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Raises</strong></p>
<table>
<thead>
<tr>
<th>Exception</th>
<th>Condition</th>
</tr>
</thead>
<tbody>
<tr>
<td>RuntimeError</td>
<td></td>
</tr>
<tr>
<td>TypeError</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="bprrecommend_items"><code>BPR.recommend_items</code><a class="headerlink" href="#bprrecommend_items" title="Permanent link">&para;</a></h4>
<p>Top-N items for a user.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.bpr</span><span class="w"> </span><span class="kn">import</span> <span class="n">BPR</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="n">BPR</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[Any, Any]&#39;</span>
</span></code></pre></div>
<hr />
<hr />
<h3 id="fm"><code>FM</code><a class="headerlink" href="#fm" title="Permanent link">&para;</a></h3>
<p>Factorization Machines (FM) context-aware model for predictive tasks (e.g. CTR).</p>
<p>This model supports binary classification tasks using Log Loss (Binary Cross Entropy).
Inputs should be formatted as a scipy sparse CSR matrix where features are binary (0/1).
Each row is a sample consisting of User, Item, and Context features.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fm</span><span class="w"> </span><span class="kn">import</span> <span class="n">FM</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a><span class="n">FM</span><span class="p">(</span><span class="n">factors</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">regularization</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">iterations</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>factors</td>
<td>int</td>
<td>Number of latent factors for the cross terms (default: 8).</td>
</tr>
<tr>
<td>learning_rate</td>
<td>float</td>
<td>SGD learning rate (default: 0.05).</td>
</tr>
<tr>
<td>regularization</td>
<td>float</td>
<td>L2 regularization weight (default: 0.01).</td>
</tr>
<tr>
<td>iterations</td>
<td>int</td>
<td>Number of training epochs (default: 100).</td>
</tr>
<tr>
<td>seed</td>
<td>int</td>
<td>Random seed for SGD sampling (default: 42).</td>
</tr>
<tr>
<td>verbose</td>
<td>bool</td>
<td>Whether to print training progress (default: False).</td>
</tr>
</tbody>
</table>
<h4 id="fmfit"><code>FM.fit</code><a class="headerlink" href="#fmfit" title="Permanent link">&para;</a></h4>
<p>Fit the FM model to Context-aware Data.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fm</span><span class="w"> </span><span class="kn">import</span> <span class="n">FM</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a><span class="n">FM</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;FM&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>X</td>
<td>scipy.sparse.csr_matrix or numpy array</td>
<td>Sparse binary feature matrix of shape (n_samples, n_features). Each row represents a single interaction with all its context features.</td>
</tr>
<tr>
<td>y</td>
<td>numpy.ndarray</td>
<td>Binary target labels (0.0 or 1.0) of shape (n_samples,).</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="fmpredict"><code>FM.predict</code><a class="headerlink" href="#fmpredict" title="Permanent link">&para;</a></h4>
<p>Alias for :meth:<code>predict_proba</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fm</span><span class="w"> </span><span class="kn">import</span> <span class="n">FM</span><span class="o">.</span><span class="n">predict</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="n">FM</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<hr />
<h4 id="fmpredict_proba"><code>FM.predict_proba</code><a class="headerlink" href="#fmpredict_proba" title="Permanent link">&para;</a></h4>
<p>Predict the probability (CTR) of interactions.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fm</span><span class="w"> </span><span class="kn">import</span> <span class="n">FM</span><span class="o">.</span><span class="n">predict_proba</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a><span class="n">FM</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>X</td>
<td>scipy.sparse.csr_matrix or numpy array</td>
<td>Sparse binary feature matrix of shape (n_samples, n_features).</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>numpy.ndarray</td>
<td></td>
<td>Predicted probabilities of shape (n_samples,).</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="recommender"><code>Recommender</code><a class="headerlink" href="#recommender" title="Permanent link">&para;</a></h3>
<p>Hybrid recommender combining ALS collaborative filtering, semantic similarities, and association rules.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.recommend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Recommender</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="n">Recommender</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="s1">&#39;Any | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rules_df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item_embeddings</span><span class="p">:</span> <span class="s1">&#39;np.ndarray | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="recommenderpredict_next_chunk"><code>Recommender.predict_next_chunk</code><a class="headerlink" href="#recommenderpredict_next_chunk" title="Permanent link">&para;</a></h4>
<p>Batch-rank the next best products for every user in <em>user_history_df</em>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.recommend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Recommender</span><span class="o">.</span><span class="n">predict_next_chunk</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="n">Recommender</span><span class="o">.</span><span class="n">predict_next_chunk</span><span class="p">(</span><span class="n">user_history_df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame&#39;</span><span class="p">,</span> <span class="n">user_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h4 id="recommenderrecommend_for_cart"><code>Recommender.recommend_for_cart</code><a class="headerlink" href="#recommenderrecommend_for_cart" title="Permanent link">&para;</a></h4>
<p>Suggest items to add to an active cart using association rules.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.recommend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Recommender</span><span class="o">.</span><span class="n">recommend_for_cart</span>
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a><span class="n">Recommender</span><span class="o">.</span><span class="n">recommend_for_cart</span><span class="p">(</span><span class="n">cart_items</span><span class="p">:</span> <span class="s1">&#39;list[int]&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;list[int]&#39;</span>
</span></code></pre></div>
<hr />
<h4 id="recommenderrecommend_for_user"><code>Recommender.recommend_for_user</code><a class="headerlink" href="#recommenderrecommend_for_user" title="Permanent link">&para;</a></h4>
<p>Top-N recommendations for a user via Hybrid ALS + Semantic.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.recommend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Recommender</span><span class="o">.</span><span class="n">recommend_for_user</span>
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="n">Recommender</span><span class="o">.</span><span class="n">recommend_for_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">target_item_for_semantic</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[np.ndarray, np.ndarray]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int</td>
<td>The user ID to generate recommendations for.</td>
</tr>
<tr>
<td>n</td>
<td>int, default=5</td>
<td>Number of items to return.</td>
</tr>
<tr>
<td>alpha</td>
<td>float, default=0.5</td>
<td>Weight blending CF vs Semantic. <code>alpha=1.0</code> is pure CF. <code>alpha=0.0</code> is pure semantic.</td>
</tr>
<tr>
<td>target_item_for_semantic</td>
<td>int | None, default=None</td>
<td>If provided, semantic similarity is computed against this item. If None, and alpha &lt; 1.0, it computes semantic similarity against the user's most recently interacted item (if history is available) or falls back to pure CF.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="nextbestaction"><code>NextBestAction</code><a class="headerlink" href="#nextbestaction" title="Permanent link">&para;</a></h3>
<p>Hybrid recommender combining ALS collaborative filtering, semantic similarities, and association rules.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.recommend</span><span class="w"> </span><span class="kn">import</span> <span class="n">NextBestAction</span>
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a><span class="n">NextBestAction</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="s1">&#39;Any | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rules_df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item_embeddings</span><span class="p">:</span> <span class="s1">&#39;np.ndarray | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="nextbestactionpredict_next_chunk"><code>NextBestAction.predict_next_chunk</code><a class="headerlink" href="#nextbestactionpredict_next_chunk" title="Permanent link">&para;</a></h4>
<p>Batch-rank the next best products for every user in <em>user_history_df</em>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.recommend</span><span class="w"> </span><span class="kn">import</span> <span class="n">NextBestAction</span><span class="o">.</span><span class="n">predict_next_chunk</span>
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a><span class="n">NextBestAction</span><span class="o">.</span><span class="n">predict_next_chunk</span><span class="p">(</span><span class="n">user_history_df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame&#39;</span><span class="p">,</span> <span class="n">user_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<hr />
<h4 id="nextbestactionrecommend_for_cart"><code>NextBestAction.recommend_for_cart</code><a class="headerlink" href="#nextbestactionrecommend_for_cart" title="Permanent link">&para;</a></h4>
<p>Suggest items to add to an active cart using association rules.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.recommend</span><span class="w"> </span><span class="kn">import</span> <span class="n">NextBestAction</span><span class="o">.</span><span class="n">recommend_for_cart</span>
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a><span class="n">NextBestAction</span><span class="o">.</span><span class="n">recommend_for_cart</span><span class="p">(</span><span class="n">cart_items</span><span class="p">:</span> <span class="s1">&#39;list[int]&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;list[int]&#39;</span>
</span></code></pre></div>
<hr />
<h4 id="nextbestactionrecommend_for_user"><code>NextBestAction.recommend_for_user</code><a class="headerlink" href="#nextbestactionrecommend_for_user" title="Permanent link">&para;</a></h4>
<p>Top-N recommendations for a user via Hybrid ALS + Semantic.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.recommend</span><span class="w"> </span><span class="kn">import</span> <span class="n">NextBestAction</span><span class="o">.</span><span class="n">recommend_for_user</span>
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a><span class="n">NextBestAction</span><span class="o">.</span><span class="n">recommend_for_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">target_item_for_semantic</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[np.ndarray, np.ndarray]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int</td>
<td>The user ID to generate recommendations for.</td>
</tr>
<tr>
<td>n</td>
<td>int, default=5</td>
<td>Number of items to return.</td>
</tr>
<tr>
<td>alpha</td>
<td>float, default=0.5</td>
<td>Weight blending CF vs Semantic. <code>alpha=1.0</code> is pure CF. <code>alpha=0.0</code> is pure semantic.</td>
</tr>
<tr>
<td>target_item_for_semantic</td>
<td>int | None, default=None</td>
<td>If provided, semantic similarity is computed against this item. If None, and alpha &lt; 1.0, it computes semantic similarity against the user's most recently interacted item (if history is available) or falls back to pure CF.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="ease"><code>EASE</code><a class="headerlink" href="#ease" title="Permanent link">&para;</a></h3>
<p>Embarrassingly Shallow Autoencoders for Sparse Data (EASE).</p>
<p>An implicit collaborative filtering algorithm that computes a closed-form
item-item similarity matrix by solving a ridge regression problem. EASE
often achieves state-of-the-art recommendation quality and very fast
inference, particularly on datasets with strong item-item correlations.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.ease</span><span class="w"> </span><span class="kn">import</span> <span class="n">EASE</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a>
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a><span class="n">EASE</span><span class="p">(</span><span class="n">regularization</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">500.0</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>regularization</td>
<td>float</td>
<td>L2 regularization weight (lambda). Higher values encourage smaller weights and reduce overfitting. Default is 500.0.</td>
</tr>
</tbody>
</table>
<h4 id="easefit"><code>EASE.fit</code><a class="headerlink" href="#easefit" title="Permanent link">&para;</a></h4>
<p>Fit the model to the user-item interaction matrix.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.ease</span><span class="w"> </span><span class="kn">import</span> <span class="n">EASE</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a><span class="n">EASE</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">interactions</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EASE&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>interactions</td>
<td>sparse matrix or numpy array, optional</td>
<td>If None, uses the matrix prepared by <code>from_transactions()</code>.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="easerecommend_items"><code>EASE.recommend_items</code><a class="headerlink" href="#easerecommend_items" title="Permanent link">&para;</a></h4>
<p>Top-N items for a user. Set exclude_seen=False to include already-seen items.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.ease</span><span class="w"> </span><span class="kn">import</span> <span class="n">EASE</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a><span class="n">EASE</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[Any, Any]&#39;</span>
</span></code></pre></div>
<hr />
<hr />
<h3 id="itemknn"><code>ItemKNN</code><a class="headerlink" href="#itemknn" title="Permanent link">&para;</a></h3>
<p>Ultra-fast Sparse Item-Item K-Nearest Neighbors Recommender.</p>
<p>Computes an item-item similarity matrix and only retains the top-K neighbors
per item. Similarity methods include BM25, TF-IDF, Cosine, or unweighted Count.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.item_knn</span><span class="w"> </span><span class="kn">import</span> <span class="n">ItemKNN</span>
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a><span class="n">ItemKNN</span><span class="p">(</span><span class="n">method</span><span class="p">:</span> <span class="s2">&quot;Literal[&#39;bm25&#39;, &#39;tfidf&#39;, &#39;cosine&#39;, &#39;count&#39;]&quot;</span> <span class="o">=</span> <span class="s1">&#39;bm25&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">bm25_k1</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">bm25_b</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="itemknnfit"><code>ItemKNN.fit</code><a class="headerlink" href="#itemknnfit" title="Permanent link">&para;</a></h4>
<p>Fit the ItemKNN model.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.item_knn</span><span class="w"> </span><span class="kn">import</span> <span class="n">ItemKNN</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a><span class="n">ItemKNN</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">interactions</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ItemKNN&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>interactions</td>
<td>scipy.sparse.csr_matrix, optional</td>
<td>A sparse matrix of shape (n_users, n_items). If None, uses the matrix prepared by <code>from_transactions()</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ItemKNN</td>
<td></td>
<td>The fitted model.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="itemknnrecommend_items"><code>ItemKNN.recommend_items</code><a class="headerlink" href="#itemknnrecommend_items" title="Permanent link">&para;</a></h4>
<p>Top-N items for a user.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.item_knn</span><span class="w"> </span><span class="kn">import</span> <span class="n">ItemKNN</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a><span class="n">ItemKNN</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[Any, Any]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int</td>
<td>The user ID to generate recommendations for.</td>
</tr>
<tr>
<td>n</td>
<td>int, default=10</td>
<td>Number of items to return.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool, default=True</td>
<td>Whether to exclude items the user has already interacted with.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[np.ndarray, np.ndarray]</td>
<td></td>
<td><code>(item_ids, scores)</code> sorted by descending score.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="fpmc"><code>FPMC</code><a class="headerlink" href="#fpmc" title="Permanent link">&para;</a></h3>
<p>Factorizing Personalized Markov Chains (FPMC) model for sequential recommendation.</p>
<p>FPMC combines Matrix Factorization (modeling user preferences) and Markov Chains
(modeling sequential transitions between items). It is highly effective for tasks
where both personal taste and sequential behavior matter (e.g., next-basket delivery).</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fpmc</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMC</span>
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a><span class="n">FPMC</span><span class="p">(</span><span class="n">factors</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">regularization</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">iterations</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>factors</td>
<td>int</td>
<td>Number of latent factors (default: 64).</td>
</tr>
<tr>
<td>learning_rate</td>
<td>float</td>
<td>SGD learning rate (default: 0.05).</td>
</tr>
<tr>
<td>regularization</td>
<td>float</td>
<td>L2 regularization weight (default: 0.01).</td>
</tr>
<tr>
<td>iterations</td>
<td>int</td>
<td>Number of passes over the transitions (default: 150).</td>
</tr>
<tr>
<td>seed</td>
<td>int</td>
<td>Random seed for sampling (default: 42).</td>
</tr>
<tr>
<td>verbose</td>
<td>bool</td>
<td>Whether to print training progress (default: False).</td>
</tr>
</tbody>
</table>
<h4 id="fpmcfit"><code>FPMC.fit</code><a class="headerlink" href="#fpmcfit" title="Permanent link">&para;</a></h4>
<p>Fit the FPMC model to a list of sequential interactions.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fpmc</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMC</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a><span class="n">FPMC</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">sequences</span><span class="p">:</span> <span class="s1">&#39;list[list[int]] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_items</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;FPMC&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>sequences</td>
<td>list of list of int, optional</td>
<td>List of item sequences, where each sequence belongs to a unique user. Users are assigned IDs from 0 to len(sequences)-1. If None, uses data prepared by <code>from_transactions()</code>.</td>
</tr>
<tr>
<td>n_items</td>
<td>int | None</td>
<td>Maximum number of items. If None, it is inferred from data.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="fpmcrecommend_items"><code>FPMC.recommend_items</code><a class="headerlink" href="#fpmcrecommend_items" title="Permanent link">&para;</a></h4>
<p>Top-N sequential items for a user.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.fpmc</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPMC</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>
</span><span id="__span-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a><span class="n">FPMC</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[Any, Any]&#39;</span>
</span></code></pre></div>
<hr />
<hr />
<h3 id="svd"><code>SVD</code><a class="headerlink" href="#svd" title="Permanent link">&para;</a></h3>
<p>Funk SVD collaborative filtering model.</p>
<p>Biased matrix factorization trained with SGD:
    r̂_ui = μ + b_u + b_i + p_u · q_i</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.svd</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVD</span>
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a><span class="n">SVD</span><span class="p">(</span><span class="n">factors</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">,</span> <span class="n">regularization</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">iterations</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>factors</td>
<td>int</td>
<td>Number of latent factors.</td>
</tr>
<tr>
<td>learning_rate</td>
<td>float</td>
<td>SGD learning rate.</td>
</tr>
<tr>
<td>regularization</td>
<td>float</td>
<td>L2 regularisation weight.</td>
</tr>
<tr>
<td>iterations</td>
<td>int</td>
<td>Number of SGD epochs.</td>
</tr>
<tr>
<td>seed</td>
<td>int</td>
<td>Random seed for reproducibility.</td>
</tr>
<tr>
<td>verbose</td>
<td>int</td>
<td>Verbosity level (0 = silent, 1+ = progress).</td>
</tr>
</tbody>
</table>
<h4 id="svdbatch_recommend"><code>SVD.batch_recommend</code><a class="headerlink" href="#svdbatch_recommend" title="Permanent link">&para;</a></h4>
<p>Top-N items for all users efficiently computed in parallel.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.svd</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVD</span><span class="o">.</span><span class="n">batch_recommend</span>
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a>
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a><span class="n">SVD</span><span class="o">.</span><span class="n">batch_recommend</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;polars&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>n</td>
<td>int</td>
<td>Number of items per user.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool</td>
<td>Whether to filter already-seen items.</td>
</tr>
<tr>
<td>format</td>
<td>str</td>
<td>Output format: "polars" or "pandas".</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DataFrame</td>
<td></td>
<td>A DataFrame with columns <code>user_id</code>, <code>item_id</code>, and <code>score</code>.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="svdfit"><code>SVD.fit</code><a class="headerlink" href="#svdfit" title="Permanent link">&para;</a></h4>
<p>Fit the model to the user-item interaction matrix.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.svd</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVD</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a><span class="n">SVD</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">interactions</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;SVD&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>interactions</td>
<td>scipy.sparse matrix, np.ndarray, pd.DataFrame, or polars DataFrame, optional</td>
<td>User-item interaction matrix with explicit ratings. If None, uses the matrix prepared by <code>from_transactions()</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>self</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="svdpredict"><code>SVD.predict</code><a class="headerlink" href="#svdpredict" title="Permanent link">&para;</a></h4>
<p>Predict the rating for a user-item pair.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.svd</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVD</span><span class="o">.</span><span class="n">predict</span>
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a><span class="n">SVD</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">item_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;float&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int</td>
<td>User index.</td>
</tr>
<tr>
<td>item_id</td>
<td>int</td>
<td>Item index.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>float</td>
<td></td>
<td>Predicted rating.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="svdrecommend_items"><code>SVD.recommend_items</code><a class="headerlink" href="#svdrecommend_items" title="Permanent link">&para;</a></h4>
<p>Top-N items for a user.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.svd</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVD</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a>
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a><span class="n">SVD</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[Any, Any]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int</td>
<td>User index.</td>
</tr>
<tr>
<td>n</td>
<td>int</td>
<td>Number of items to recommend.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool</td>
<td>Whether to filter already-seen items.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[np.ndarray, np.ndarray]</td>
<td></td>
<td>(item_ids, scores)</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="svdrecommend_users"><code>SVD.recommend_users</code><a class="headerlink" href="#svdrecommend_users" title="Permanent link">&para;</a></h4>
<p>Top-N users for an item.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.svd</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVD</span><span class="o">.</span><span class="n">recommend_users</span>
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a>
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a><span class="n">SVD</span><span class="o">.</span><span class="n">recommend_users</span><span class="p">(</span><span class="n">item_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[Any, Any]&#39;</span>
</span></code></pre></div>
<hr />
<hr />
<h3 id="lightgcn"><code>LightGCN</code><a class="headerlink" href="#lightgcn" title="Permanent link">&para;</a></h3>
<p>LightGCN: Simplifying and Powering Graph Convolution Network for Recommendation.</p>
<p>A state-of-the-art collaborative filtering model that propagates embeddings
over the user–item bipartite graph without non-linear transformations.</p>
<p>Typical training time on ml-100k: &lt; 0.5s/epoch.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.lightgcn</span><span class="w"> </span><span class="kn">import</span> <span class="n">LightGCN</span>
</span><span id="__span-86-2"><a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a>
</span><span id="__span-86-3"><a id="__codelineno-86-3" name="__codelineno-86-3" href="#__codelineno-86-3"></a><span class="n">LightGCN</span><span class="p">(</span><span class="n">factors</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">k_layers</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="n">iterations</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>factors</td>
<td>int</td>
<td>Embedding dimensionality (latent factors).</td>
</tr>
<tr>
<td>k_layers</td>
<td>int</td>
<td>Number of graph-propagation layers (1–4).</td>
</tr>
<tr>
<td>learning_rate</td>
<td>float</td>
<td>Adam learning rate.</td>
</tr>
<tr>
<td>lambda_</td>
<td>float</td>
<td>L2 regularization coefficient.</td>
</tr>
<tr>
<td>iterations</td>
<td>int</td>
<td>Number of training epochs.</td>
</tr>
<tr>
<td>seed</td>
<td>int or None</td>
<td>Seed for reproducible training.</td>
</tr>
<tr>
<td>verbose</td>
<td>int</td>
<td>Print training progress.</td>
</tr>
</tbody>
</table>
<h4 id="lightgcnfit"><code>LightGCN.fit</code><a class="headerlink" href="#lightgcnfit" title="Permanent link">&para;</a></h4>
<p>Fit the model to a user-item interaction matrix.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.lightgcn</span><span class="w"> </span><span class="kn">import</span> <span class="n">LightGCN</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a><span class="n">LightGCN</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">interactions</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;LightGCN&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>interactions</td>
<td>scipy.sparse.csr_matrix or numpy.ndarray, optional</td>
<td>A sparse or dense user-item interaction matrix. If None, uses data prepared by <code>from_transactions()</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>LightGCN</td>
<td></td>
<td>The fitted model.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="lightgcnrecommend_items"><code>LightGCN.recommend_items</code><a class="headerlink" href="#lightgcnrecommend_items" title="Permanent link">&para;</a></h4>
<p>Top-N items for a user.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.lightgcn</span><span class="w"> </span><span class="kn">import</span> <span class="n">LightGCN</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a><span class="n">LightGCN</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[np.ndarray, np.ndarray]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int</td>
<td>Original user ID (before encoding).</td>
</tr>
<tr>
<td>n</td>
<td>int, default=10</td>
<td>Number of recommendations.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool, default=True</td>
<td>Whether to exclude items the user has already interacted with.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[np.ndarray, np.ndarray]</td>
<td></td>
<td><code>(item_ids, scores)</code> sorted by descending score.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="sasrec"><code>SASRec</code><a class="headerlink" href="#sasrec" title="Permanent link">&para;</a></h3>
<p>SASRec – Self-Attentive Sequential Recommendation.</p>
<p>Applies a causal Transformer to user interaction sequences to predict
the next item. Significantly outperforms Markov-chain methods like FPMC
on long sequences.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.sasrec</span><span class="w"> </span><span class="kn">import</span> <span class="n">SASRec</span>
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a>
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a><span class="n">SASRec</span><span class="p">(</span><span class="n">factors</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">n_layers</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max_seq</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="n">iterations</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>factors</td>
<td>int</td>
<td>Embedding dimensionality.</td>
</tr>
<tr>
<td>n_layers</td>
<td>int</td>
<td>Number of Transformer blocks.</td>
</tr>
<tr>
<td>max_seq</td>
<td>int</td>
<td>Maximum input sequence length (older items are dropped).</td>
</tr>
<tr>
<td>learning_rate</td>
<td>float</td>
<td>SGD learning rate (decays during training).</td>
</tr>
<tr>
<td>lambda_</td>
<td>float</td>
<td>L2 regularization.</td>
</tr>
<tr>
<td>iterations</td>
<td>int</td>
<td>Number of training epochs.</td>
</tr>
<tr>
<td>seed</td>
<td>int or None</td>
<td>Seed for reproducibility.</td>
</tr>
<tr>
<td>verbose</td>
<td>int</td>
<td>Print epoch progress.</td>
</tr>
</tbody>
</table>
<h4 id="sasrecfit"><code>SASRec.fit</code><a class="headerlink" href="#sasrecfit" title="Permanent link">&para;</a></h4>
<p>Train SASRec on integer-encoded sequences (0-indexed item IDs).</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.sasrec</span><span class="w"> </span><span class="kn">import</span> <span class="n">SASRec</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a>
</span><span id="__span-90-3"><a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a><span class="n">SASRec</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">sequences</span><span class="p">:</span> <span class="s1">&#39;list[list[int]] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;SASRec&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>sequences</td>
<td>list of list of int, optional</td>
<td>List of per-user interaction histories (item IDs). If None, uses data prepared by <code>from_transactions()</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SASRec</td>
<td></td>
<td>The fitted model.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="sasrecrecommend_items"><code>SASRec.recommend_items</code><a class="headerlink" href="#sasrecrecommend_items" title="Permanent link">&para;</a></h4>
<p>Top-N items for a user or an ad-hoc sequence.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.sasrec</span><span class="w"> </span><span class="kn">import</span> <span class="n">SASRec</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a>
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a><span class="n">SASRec</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int | list[int]&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[np.ndarray, np.ndarray]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int or list[int]</td>
<td>The ID of the user (implicitly 0 to len(sequences)-1 from fit), or a list of items representing an ad-hoc sequence.</td>
</tr>
<tr>
<td>n</td>
<td>int, default=10</td>
<td>Number of recommendations.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool, default=True</td>
<td>Whether to exclude items the user has already interacted with.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[np.ndarray, np.ndarray]</td>
<td></td>
<td><code>(item_ids, scores)</code> sorted by descending score.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="popularityrecommender"><code>PopularityRecommender</code><a class="headerlink" href="#popularityrecommender" title="Permanent link">&para;</a></h3>
<p>Recommend items by global popularity (interaction count).</p>
<p>A non-personalised baseline that ranks every item by the total number
of interactions it received.  Useful as a sanity-check baseline when
evaluating more sophisticated models.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.popularity</span><span class="w"> </span><span class="kn">import</span> <span class="n">PopularityRecommender</span>
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a>
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a><span class="n">PopularityRecommender</span><span class="p">(</span><span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>verbose</td>
<td>int, default=0</td>
<td>Verbosity level.</td>
</tr>
</tbody>
</table>
<h4 id="popularityrecommenderfit"><code>PopularityRecommender.fit</code><a class="headerlink" href="#popularityrecommenderfit" title="Permanent link">&para;</a></h4>
<p>Fit the model by counting interactions per item.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.popularity</span><span class="w"> </span><span class="kn">import</span> <span class="n">PopularityRecommender</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a>
</span><span id="__span-93-3"><a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a><span class="n">PopularityRecommender</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">interactions</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PopularityRecommender&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>interactions</td>
<td>sparse matrix or numpy array, optional</td>
<td>User-item interaction matrix.  If <em>None</em>, uses the matrix prepared by <code>from_transactions()</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PopularityRecommender</td>
<td></td>
<td>The fitted model.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="popularityrecommenderrecommend_items"><code>PopularityRecommender.recommend_items</code><a class="headerlink" href="#popularityrecommenderrecommend_items" title="Permanent link">&para;</a></h4>
<p>Return the <em>n</em> most popular items for a user.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.popularity</span><span class="w"> </span><span class="kn">import</span> <span class="n">PopularityRecommender</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a>
</span><span id="__span-94-3"><a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a><span class="n">PopularityRecommender</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[np.ndarray, np.ndarray]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int</td>
<td>Internal user index.</td>
</tr>
<tr>
<td>n</td>
<td>int, default=10</td>
<td>Number of items to return.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool, default=True</td>
<td>Whether to exclude items the user has already interacted with.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[np.ndarray, np.ndarray]</td>
<td></td>
<td><code>(item_ids, scores)</code> sorted by descending popularity.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="contentbased"><code>ContentBased</code><a class="headerlink" href="#contentbased" title="Permanent link">&para;</a></h3>
<p>Content-based recommender using TF-IDF vectorization and cosine similarity.</p>
<p>Recommends items similar to a given item based on textual features
(descriptions, tags, genres, etc.).</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.content_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">ContentBased</span>
</span><span id="__span-95-2"><a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a>
</span><span id="__span-95-3"><a id="__codelineno-95-3" name="__codelineno-95-3" href="#__codelineno-95-3"></a><span class="n">ContentBased</span><span class="p">(</span><span class="n">max_features</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">ngram_range</span><span class="p">:</span> <span class="s1">&#39;tuple[int, int]&#39;</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>max_features</td>
<td>int, default=5000</td>
<td>Maximum number of TF-IDF features to extract.</td>
</tr>
<tr>
<td>ngram_range</td>
<td>tuple[int, int], default=(1, 2)</td>
<td>Range of n-grams for TF-IDF vectorisation.</td>
</tr>
</tbody>
</table>
<h4 id="contentbasedfit"><code>ContentBased.fit</code><a class="headerlink" href="#contentbasedfit" title="Permanent link">&para;</a></h4>
<p>Compute TF-IDF vectors and the pairwise cosine similarity matrix.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.content_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">ContentBased</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a>
</span><span id="__span-96-3"><a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a><span class="n">ContentBased</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s1">&#39;ContentBased&#39;</span>
</span></code></pre></div>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ContentBased</td>
<td></td>
<td>The fitted model.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="contentbasedrecommend_similar"><code>ContentBased.recommend_similar</code><a class="headerlink" href="#contentbasedrecommend_similar" title="Permanent link">&para;</a></h4>
<p>Find the <em>n</em> most similar items to a given item.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.content_based</span><span class="w"> </span><span class="kn">import</span> <span class="n">ContentBased</span><span class="o">.</span><span class="n">recommend_similar</span>
</span><span id="__span-97-2"><a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a>
</span><span id="__span-97-3"><a id="__codelineno-97-3" name="__codelineno-97-3" href="#__codelineno-97-3"></a><span class="n">ContentBased</span><span class="o">.</span><span class="n">recommend_similar</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[np.ndarray, np.ndarray]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td>Any</td>
<td>Item ID (as it appeared in <code>item_col</code> of the source DataFrame).</td>
</tr>
<tr>
<td>n</td>
<td>int, default=10</td>
<td>Number of similar items to return.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[np.ndarray, np.ndarray]</td>
<td></td>
<td><code>(item_ids, similarity_scores)</code> sorted by descending similarity.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="hybridrecommender"><code>HybridRecommender</code><a class="headerlink" href="#hybridrecommender" title="Permanent link">&para;</a></h3>
<p>Weighted ensemble of multiple recommendation models.</p>
<p>Blends the output of several pre-fitted models by combining their
<code>recommend_items</code> scores with configurable weights.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.hybrid</span><span class="w"> </span><span class="kn">import</span> <span class="n">HybridRecommender</span>
</span><span id="__span-98-2"><a id="__codelineno-98-2" name="__codelineno-98-2" href="#__codelineno-98-2"></a>
</span><span id="__span-98-3"><a id="__codelineno-98-3" name="__codelineno-98-3" href="#__codelineno-98-3"></a><span class="n">HybridRecommender</span><span class="p">(</span><span class="n">models_and_weights</span><span class="p">:</span> <span class="s1">&#39;list[tuple[Any, float]]&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>models_and_weights</td>
<td>list[tuple[Any, float]]</td>
<td>List of <code>(model, weight)</code> pairs.  Each model must implement <code>recommend_items(user_id, n, exclude_seen) -&gt; (ids, scores)</code>.</td>
</tr>
</tbody>
</table>
<h4 id="hybridrecommenderfit"><code>HybridRecommender.fit</code><a class="headerlink" href="#hybridrecommenderfit" title="Permanent link">&para;</a></h4>
<p>No-op — constituent models must be pre-fitted.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.hybrid</span><span class="w"> </span><span class="kn">import</span> <span class="n">HybridRecommender</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-99-2"><a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a>
</span><span id="__span-99-3"><a id="__codelineno-99-3" name="__codelineno-99-3" href="#__codelineno-99-3"></a><span class="n">HybridRecommender</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="s1">&#39;HybridRecommender&#39;</span>
</span></code></pre></div>
<hr />
<h4 id="hybridrecommenderrecommend_items"><code>HybridRecommender.recommend_items</code><a class="headerlink" href="#hybridrecommenderrecommend_items" title="Permanent link">&para;</a></h4>
<p>Blend recommendations from all constituent models.</p>
<p>For each model, requests a large candidate set (<code>n * 3</code>), maps item
scores into a shared score vector, applies the weight, and returns the
top-<em>n</em> from the blended result.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.hybrid</span><span class="w"> </span><span class="kn">import</span> <span class="n">HybridRecommender</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-100-2"><a id="__codelineno-100-2" name="__codelineno-100-2" href="#__codelineno-100-2"></a>
</span><span id="__span-100-3"><a id="__codelineno-100-3" name="__codelineno-100-3" href="#__codelineno-100-3"></a><span class="n">HybridRecommender</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[np.ndarray, np.ndarray]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int</td>
<td>Internal user index.</td>
</tr>
<tr>
<td>n</td>
<td>int, default=10</td>
<td>Number of items to return.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool, default=True</td>
<td>Whether to exclude items already seen.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[np.ndarray, np.ndarray]</td>
<td></td>
<td><code>(item_ids, blended_scores)</code> sorted by descending score.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="nmf"><code>NMF</code><a class="headerlink" href="#nmf" title="Permanent link">&para;</a></h3>
<p>Non-negative Matrix Factorization for collaborative filtering.</p>
<p>Decomposes the user-item interaction matrix <strong>R</strong> into two non-negative
matrices <strong>W</strong> (users × factors) and <strong>H</strong> (factors × items) such that
<code>R ≈ W @ H</code>.  The multiplicative update rules guarantee non-negativity
without a projection step.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.nmf</span><span class="w"> </span><span class="kn">import</span> <span class="n">NMF</span>
</span><span id="__span-101-2"><a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a>
</span><span id="__span-101-3"><a id="__codelineno-101-3" name="__codelineno-101-3" href="#__codelineno-101-3"></a><span class="n">NMF</span><span class="p">(</span><span class="n">factors</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">iterations</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">regularization</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>factors</td>
<td>int, default=64</td>
<td>Number of latent factors.</td>
</tr>
<tr>
<td>iterations</td>
<td>int, default=100</td>
<td>Number of multiplicative update iterations.</td>
</tr>
<tr>
<td>regularization</td>
<td>float, default=0.01</td>
<td>L2 regularisation penalty applied to both W and H.</td>
</tr>
<tr>
<td>seed</td>
<td>int, default=42</td>
<td>Random seed for initialisation.</td>
</tr>
<tr>
<td>verbose</td>
<td>int, default=0</td>
<td>Verbosity level.</td>
</tr>
</tbody>
</table>
<h4 id="nmffit"><code>NMF.fit</code><a class="headerlink" href="#nmffit" title="Permanent link">&para;</a></h4>
<p>Fit via multiplicative update rules.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.nmf</span><span class="w"> </span><span class="kn">import</span> <span class="n">NMF</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-102-2"><a id="__codelineno-102-2" name="__codelineno-102-2" href="#__codelineno-102-2"></a>
</span><span id="__span-102-3"><a id="__codelineno-102-3" name="__codelineno-102-3" href="#__codelineno-102-3"></a><span class="n">NMF</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">interactions</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;NMF&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>interactions</td>
<td>sparse matrix or numpy array, optional</td>
<td>User-item interaction matrix.  If <em>None</em>, uses the matrix prepared by <code>from_transactions()</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>NMF</td>
<td></td>
<td>The fitted model.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="nmfrecommend_items"><code>NMF.recommend_items</code><a class="headerlink" href="#nmfrecommend_items" title="Permanent link">&para;</a></h4>
<p>Top-N items for a user via W @ H^T.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.nmf</span><span class="w"> </span><span class="kn">import</span> <span class="n">NMF</span><span class="o">.</span><span class="n">recommend_items</span>
</span><span id="__span-103-2"><a id="__codelineno-103-2" name="__codelineno-103-2" href="#__codelineno-103-2"></a>
</span><span id="__span-103-3"><a id="__codelineno-103-3" name="__codelineno-103-3" href="#__codelineno-103-3"></a><span class="n">NMF</span><span class="o">.</span><span class="n">recommend_items</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[np.ndarray, np.ndarray]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int</td>
<td>Internal user index.</td>
</tr>
<tr>
<td>n</td>
<td>int, default=10</td>
<td>Number of items to return.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool, default=True</td>
<td>Whether to exclude already-seen items.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[np.ndarray, np.ndarray]</td>
<td></td>
<td><code>(item_ids, scores)</code> sorted by descending score.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h2 id="analytics-utilities">Analytics &amp; Utilities<a class="headerlink" href="#analytics-utilities" title="Permanent link">&para;</a></h2>
<h3 id="score_potential"><code>score_potential</code><a class="headerlink" href="#score_potential" title="Permanent link">&para;</a></h3>
<p>Cross-selling potential scores — shape <code>(n_users, n_items)</code> or <code>(n_users, len(target_categories))</code>.</p>
<p>Items the user has already interacted with are masked to <code>-inf</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.recommend</span><span class="w"> </span><span class="kn">import</span> <span class="n">score_potential</span>
</span><span id="__span-104-2"><a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a>
</span><span id="__span-104-3"><a id="__codelineno-104-3" name="__codelineno-104-3" href="#__codelineno-104-3"></a><span class="n">score_potential</span><span class="p">(</span><span class="n">user_history</span><span class="p">:</span> <span class="s1">&#39;list[list[int]]&#39;</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">target_categories</span><span class="p">:</span> <span class="s1">&#39;list[int] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;np.ndarray&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="similar_items"><code>similar_items</code><a class="headerlink" href="#similar_items" title="Permanent link">&para;</a></h3>
<p>Find the most similar items to a given item ID based on latent factors.</p>
<p>Computes cosine similarity between the specified item's latent vector
and all other item vectors in the <code>item_factors</code> matrix.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.similarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">similar_items</span>
</span><span id="__span-105-2"><a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a>
</span><span id="__span-105-3"><a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a><span class="n">similar_items</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="s1">&#39;SupportsItemFactors&#39;</span><span class="p">,</span> <span class="n">item_id</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[np.ndarray, np.ndarray]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>model</td>
<td>SupportsItemFactors</td>
<td>A fitted model instance with an <code>item_factors</code> property.</td>
</tr>
<tr>
<td>item_id</td>
<td>int</td>
<td>The internal integer index of the target item.</td>
</tr>
<tr>
<td>n</td>
<td>int</td>
<td>Number of most similar items to return.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[np.ndarray, np.ndarray]</td>
<td></td>
<td><code>(item_ids, cosine_similarities)</code> sorted in descending order.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="find_substitutes"><code>find_substitutes</code><a class="headerlink" href="#find_substitutes" title="Permanent link">&para;</a></h3>
<p>Substitute/cannibalizing products via negative association rules.</p>
<p>Items with high individual support but low co-occurrence (lift &lt; 1.0)
likely cannibalize each other.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.analytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">find_substitutes</span>
</span><span id="__span-106-2"><a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a>
</span><span id="__span-106-3"><a id="__codelineno-106-3" name="__codelineno-106-3" href="#__codelineno-106-3"></a><span class="n">find_substitutes</span><span class="p">(</span><span class="n">rules_df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame&#39;</span><span class="p">,</span> <span class="n">max_lift</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>rules_df</td>
<td></td>
<td>DataFrame output from <code>rusket.association_rules</code>.</td>
</tr>
<tr>
<td>max_lift</td>
<td></td>
<td>Upper bound for lift; lift &lt; 1.0 implies negative correlation.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pd.DataFrame sorted ascending by lift (most severe cannibalization first).</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="customer_saturation"><code>customer_saturation</code><a class="headerlink" href="#customer_saturation" title="Permanent link">&para;</a></h3>
<p>Customer saturation by unique items/categories bought, split into deciles.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.analytics</span><span class="w"> </span><span class="kn">import</span> <span class="n">customer_saturation</span>
</span><span id="__span-107-2"><a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a>
</span><span id="__span-107-3"><a id="__codelineno-107-3" name="__codelineno-107-3" href="#__codelineno-107-3"></a><span class="n">customer_saturation</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame&#39;</span><span class="p">,</span> <span class="n">user_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">category_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;pd.DataFrame&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>df</td>
<td></td>
<td>Interaction DataFrame.</td>
</tr>
<tr>
<td>user_col</td>
<td></td>
<td>Column identifying the user.</td>
</tr>
<tr>
<td>category_col</td>
<td></td>
<td>Category column (optional; at least one of category/item required).</td>
</tr>
<tr>
<td>item_col</td>
<td></td>
<td>Item column (optional).</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pd.DataFrame with <code>unique_count</code>, <code>saturation_pct</code>, and <code>decile</code> columns.</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="export_item_factors"><code>export_item_factors</code><a class="headerlink" href="#export_item_factors" title="Permanent link">&para;</a></h3>
<p>Exports latent item factors as a DataFrame for Vector DBs.</p>
<p>This format is ideal for ingesting into FAISS, Pinecone, or Qdrant for
Retrieval-Augmented Generation (RAG) and semantic search.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-108-1"><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.export</span><span class="w"> </span><span class="kn">import</span> <span class="n">export_item_factors</span>
</span><span id="__span-108-2"><a id="__codelineno-108-2" name="__codelineno-108-2" href="#__codelineno-108-2"></a>
</span><span id="__span-108-3"><a id="__codelineno-108-3" name="__codelineno-108-3" href="#__codelineno-108-3"></a><span class="n">export_item_factors</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="s1">&#39;SupportsItemFactors&#39;</span><span class="p">,</span> <span class="n">include_labels</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;pandas&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>model</td>
<td>SupportsItemFactors</td>
<td>A fitted model instance with an <code>item_factors</code> property.</td>
</tr>
<tr>
<td>include_labels</td>
<td>bool, default=True</td>
<td>Whether to include the string item labels (if available from the model's fitting method).</td>
</tr>
<tr>
<td>normalize</td>
<td>bool, default=False</td>
<td>Whether to L2-normalize the factors before export.</td>
</tr>
<tr>
<td>format</td>
<td>str, default="pandas"</td>
<td>The DataFrame format to return. One of "pandas", "polars", or "spark".</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Any</td>
<td></td>
<td>A DataFrame where each row is an item with columns <code>item_id</code>, optionally <code>item_label</code>, and <code>vector</code> (a dense 1-D numpy array of the item's latent factors).</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-109-1"><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">rusket</span><span class="o">.</span><span class="n">ALS</span><span class="p">(</span><span class="n">factors</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">interactions</span><span class="p">)</span>
</span><span id="__span-109-2"><a id="__codelineno-109-2" name="__codelineno-109-2" href="#__codelineno-109-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">rusket</span><span class="o">.</span><span class="n">export_item_factors</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="__span-109-3"><a id="__codelineno-109-3" name="__codelineno-109-3" href="#__codelineno-109-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Ingest into FAISS / Pinecone / Qdrant</span>
</span><span id="__span-109-4"><a id="__codelineno-109-4" name="__codelineno-109-4" href="#__codelineno-109-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;vector&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h3 id="pca_1"><code>PCA</code><a class="headerlink" href="#pca_1" title="Permanent link">&para;</a></h3>
<p>Principal Component Analysis (PCA).</p>
<p>Linear dimensionality reduction using Singular Value Decomposition
of the centred data, computed entirely in Rust via the <code>faer</code> crate.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-110-1"><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.pca</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
</span><span id="__span-110-2"><a id="__codelineno-110-2" name="__codelineno-110-2" href="#__codelineno-110-2"></a>
</span><span id="__span-110-3"><a id="__codelineno-110-3" name="__codelineno-110-3" href="#__codelineno-110-3"></a><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">svd_solver</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>n_components</td>
<td>int</td>
<td>Number of principal components to keep.</td>
</tr>
<tr>
<td>Attributes (available after <code>fit()</code>)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>----------</td>
<td></td>
<td></td>
</tr>
<tr>
<td>components_</td>
<td>np.ndarray</td>
<td>Principal axes in feature space, shape <code>(n_components, n_features)</code>.</td>
</tr>
<tr>
<td>explained_variance_</td>
<td>np.ndarray</td>
<td>Variance explained per component (uses <code>n - 1</code> degrees of freedom).</td>
</tr>
<tr>
<td>explained_variance_ratio_</td>
<td>np.ndarray</td>
<td>Fraction of total variance explained per component.</td>
</tr>
<tr>
<td>singular_values_</td>
<td>np.ndarray</td>
<td>Singular values corresponding to each component.</td>
</tr>
<tr>
<td>mean_</td>
<td>np.ndarray</td>
<td>Per-feature empirical mean estimated from the training data.</td>
</tr>
<tr>
<td>n_components_</td>
<td>int</td>
<td>Number of components that were actually fitted (may be less than requested if <code>n_components &gt; min(n_samples, n_features)</code>).</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-111-1"><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-111-2"><a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">rusket</span>
</span><span id="__span-111-3"><a id="__codelineno-111-3" name="__codelineno-111-3" href="#__codelineno-111-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="__span-111-4"><a id="__codelineno-111-4" name="__codelineno-111-4" href="#__codelineno-111-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pca</span> <span class="o">=</span> <span class="n">rusket</span><span class="o">.</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-111-5"><a id="__codelineno-111-5" name="__codelineno-111-5" href="#__codelineno-111-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="__span-111-6"><a id="__codelineno-111-6" name="__codelineno-111-6" href="#__codelineno-111-6"></a><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-111-7"><a id="__codelineno-111-7" name="__codelineno-111-7" href="#__codelineno-111-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-111-8"><a id="__codelineno-111-8" name="__codelineno-111-8" href="#__codelineno-111-8"></a><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-111-9"><a id="__codelineno-111-9" name="__codelineno-111-9" href="#__codelineno-111-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># close to fraction of total</span>
</span><span id="__span-111-10"><a id="__codelineno-111-10" name="__codelineno-111-10" href="#__codelineno-111-10"></a><span class="mf">0.4</span><span class="o">...</span>
</span></code></pre></div>
<h4 id="pcafit"><code>PCA.fit</code><a class="headerlink" href="#pcafit" title="Permanent link">&para;</a></h4>
<p>Fit PCA on the data matrix <code>X</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-112-1"><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.pca</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span><span class="o">.</span><span class="n">fit</span>
</span><span id="__span-112-2"><a id="__codelineno-112-2" name="__codelineno-112-2" href="#__codelineno-112-2"></a>
</span><span id="__span-112-3"><a id="__codelineno-112-3" name="__codelineno-112-3" href="#__codelineno-112-3"></a><span class="n">PCA</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="s1">&#39;npt.NDArray[Any]&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PCA&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>X</td>
<td>array-like of shape (n_samples, n_features)</td>
<td>Training data.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>self</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pcafit_transform"><code>PCA.fit_transform</code><a class="headerlink" href="#pcafit_transform" title="Permanent link">&para;</a></h4>
<p>Fit the model with <code>X</code> and apply dimensionality reduction.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-113-1"><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.pca</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span><span class="o">.</span><span class="n">fit_transform</span>
</span><span id="__span-113-2"><a id="__codelineno-113-2" name="__codelineno-113-2" href="#__codelineno-113-2"></a>
</span><span id="__span-113-3"><a id="__codelineno-113-3" name="__codelineno-113-3" href="#__codelineno-113-3"></a><span class="n">PCA</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="s1">&#39;npt.NDArray[Any]&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;npt.NDArray[np.float32]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>X</td>
<td>array-like of shape (n_samples, n_features)</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>X_new</td>
<td>ndarray of shape (n_samples, n_components)</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pcatransform"><code>PCA.transform</code><a class="headerlink" href="#pcatransform" title="Permanent link">&para;</a></h4>
<p>Apply dimensionality reduction to <code>X</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-114-1"><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.pca</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span><span class="o">.</span><span class="n">transform</span>
</span><span id="__span-114-2"><a id="__codelineno-114-2" name="__codelineno-114-2" href="#__codelineno-114-2"></a>
</span><span id="__span-114-3"><a id="__codelineno-114-3" name="__codelineno-114-3" href="#__codelineno-114-3"></a><span class="n">PCA</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="s1">&#39;npt.NDArray[Any]&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;npt.NDArray[np.float32]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>X</td>
<td>array-like of shape (n_samples, n_features)</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>X_new</td>
<td>ndarray of shape (n_samples, n_components)</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h3 id="pipeline"><code>Pipeline</code><a class="headerlink" href="#pipeline" title="Permanent link">&para;</a></h3>
<p>Multi-stage recommendation pipeline.</p>
<p>Composes multiple recommendation models into a <strong>retrieve → rerank → filter</strong>
funnel, following the architecture used by production recommendation systems
at Twitter/X, YouTube, and Spotify.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-115-1"><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>
</span><span id="__span-115-2"><a id="__codelineno-115-2" name="__codelineno-115-2" href="#__codelineno-115-2"></a>
</span><span id="__span-115-3"><a id="__codelineno-115-3" name="__codelineno-115-3" href="#__codelineno-115-3"></a><span class="n">Pipeline</span><span class="p">(</span><span class="n">retrieve</span><span class="p">:</span> <span class="s1">&#39;Any | list[Any] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rerank</span><span class="p">:</span> <span class="s1">&#39;Any | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">filter</span><span class="p">:</span> <span class="s1">&#39;Callable[[list[Any], list[float]], tuple[list[Any], list[float]]] | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">merge_strategy</span><span class="p">:</span> <span class="s2">&quot;Literal[&#39;max&#39;, &#39;mean&#39;, &#39;sum&#39;]&quot;</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>retrieve</td>
<td>list or single model</td>
<td>One or more <code>ImplicitRecommender</code> instances used for candidate generation.  Each model's <code>recommend_items()</code> is called and results are merged.</td>
</tr>
<tr>
<td>rerank</td>
<td>model, optional</td>
<td>An <code>ImplicitRecommender</code> used to re-score the merged candidate set. Typically a heavier model (e.g. BPR or LightGCN) that produces higher-quality rankings on a smaller candidate pool.</td>
</tr>
<tr>
<td>filter</td>
<td>callable, optional</td>
<td>A function <code>(item_ids, scores) -&gt; (filtered_ids, filtered_scores)</code> applied after re-ranking.  Use for block lists, category restrictions, recency filters, NSFW removal, etc.</td>
</tr>
<tr>
<td>merge_strategy</td>
<td>{'max', 'mean', 'sum'}, default='max'</td>
<td>How to combine scores when multiple retrievers return the same item.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-116-1"><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="__span-116-2"><a id="__codelineno-116-2" name="__codelineno-116-2" href="#__codelineno-116-2"></a><span class="o">...</span>     <span class="n">retrieve</span><span class="o">=</span><span class="p">[</span><span class="n">als</span><span class="p">,</span> <span class="n">item_knn</span><span class="p">],</span>
</span><span id="__span-116-3"><a id="__codelineno-116-3" name="__codelineno-116-3" href="#__codelineno-116-3"></a><span class="o">...</span>     <span class="n">rerank</span><span class="o">=</span><span class="n">bpr</span><span class="p">,</span>
</span><span id="__span-116-4"><a id="__codelineno-116-4" name="__codelineno-116-4" href="#__codelineno-116-4"></a><span class="o">...</span>     <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">ids</span><span class="p">,</span> <span class="n">sc</span><span class="p">:</span> <span class="p">(</span>
</span><span id="__span-116-5"><a id="__codelineno-116-5" name="__codelineno-116-5" href="#__codelineno-116-5"></a><span class="o">...</span>         <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">blocked_set</span><span class="p">],</span>
</span><span id="__span-116-6"><a id="__codelineno-116-6" name="__codelineno-116-6" href="#__codelineno-116-6"></a><span class="o">...</span>         <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">sc</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">blocked_set</span><span class="p">],</span>
</span><span id="__span-116-7"><a id="__codelineno-116-7" name="__codelineno-116-7" href="#__codelineno-116-7"></a><span class="o">...</span>     <span class="p">),</span>
</span><span id="__span-116-8"><a id="__codelineno-116-8" name="__codelineno-116-8" href="#__codelineno-116-8"></a><span class="o">...</span> <span class="p">)</span>
</span><span id="__span-116-9"><a id="__codelineno-116-9" name="__codelineno-116-9" href="#__codelineno-116-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">items</span><span class="p">,</span> <span class="n">scores</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">recommend</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="pipelinerecommend"><code>Pipeline.recommend</code><a class="headerlink" href="#pipelinerecommend" title="Permanent link">&para;</a></h4>
<p>Run the full pipeline for a single user.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-117-1"><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span><span class="o">.</span><span class="n">recommend</span>
</span><span id="__span-117-2"><a id="__codelineno-117-2" name="__codelineno-117-2" href="#__codelineno-117-2"></a>
</span><span id="__span-117-3"><a id="__codelineno-117-3" name="__codelineno-117-3" href="#__codelineno-117-3"></a><span class="n">Pipeline</span><span class="o">.</span><span class="n">recommend</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="s1">&#39;int | Any&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">retrieve_k</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[np.ndarray, np.ndarray]&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>int or any</td>
<td>The user to generate recommendations for.</td>
</tr>
<tr>
<td>n</td>
<td>int, default=10</td>
<td>Number of final items to return.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool, default=True</td>
<td>Whether to exclude items the user has already interacted with.</td>
</tr>
<tr>
<td>retrieve_k</td>
<td>int, optional</td>
<td>Number of candidates per retriever.  Defaults to <code>n * 10</code> to produce a wide candidate pool for re-ranking.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[np.ndarray, np.ndarray]</td>
<td></td>
<td><code>(item_ids, scores)</code> arrays, sorted by descending score.</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="pipelinerecommend_batch"><code>Pipeline.recommend_batch</code><a class="headerlink" href="#pipelinerecommend_batch" title="Permanent link">&para;</a></h4>
<p>Batch recommendations for multiple users.</p>
<p>Uses the <strong>Rust-accelerated</strong> fast path when all models expose
<code>user_factors</code> / <code>item_factors</code> and share the same user indexing.
Falls back to the Python per-user loop otherwise.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-118-1"><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span><span class="o">.</span><span class="n">recommend_batch</span>
</span><span id="__span-118-2"><a id="__codelineno-118-2" name="__codelineno-118-2" href="#__codelineno-118-2"></a>
</span><span id="__span-118-3"><a id="__codelineno-118-3" name="__codelineno-118-3" href="#__codelineno-118-3"></a><span class="n">Pipeline</span><span class="o">.</span><span class="n">recommend_batch</span><span class="p">(</span><span class="n">user_ids</span><span class="p">:</span> <span class="s1">&#39;list[int | Any] | np.ndarray | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">exclude_seen</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">retrieve_k</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;pandas&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_ids</td>
<td>list or array, optional</td>
<td>Users to score.  If None, uses all users from the first retriever.</td>
</tr>
<tr>
<td>n</td>
<td>int, default=10</td>
<td>Items per user.</td>
</tr>
<tr>
<td>exclude_seen</td>
<td>bool, default=True</td>
<td>Whether to exclude items users have already interacted with.</td>
</tr>
<tr>
<td>retrieve_k</td>
<td>int, optional</td>
<td>Candidates per retriever (default: <code>n * 10</code>).</td>
</tr>
<tr>
<td>format</td>
<td>str, default='pandas'</td>
<td>Output format: <code>'pandas'</code>, <code>'polars'</code>, or <code>'records'</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DataFrame or list of dicts</td>
<td></td>
<td>Columns: <code>user_id</code>, <code>item_ids</code>, <code>scores</code>.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h2 id="visualization-rusketviz">Visualization (<code>rusket.viz</code>)<a class="headerlink" href="#visualization-rusketviz" title="Permanent link">&para;</a></h2>
<p>Graph and visualization utilities.  Requires <code>networkx</code> (<code>pip install networkx</code>).</p>
<h3 id="rusketvizto_networkx"><code>rusket.viz.to_networkx</code><a class="headerlink" href="#rusketvizto_networkx" title="Permanent link">&para;</a></h3>
<p>Convert a Rusket association rules DataFrame into a NetworkX Directed Graph.</p>
<p>Nodes represent individual items. Directed edges represent rules
(antecedent → consequent). Edge weights are set by the <code>edge_attr</code>
parameter (typically lift or confidence).</p>
<p>This is extremely useful for running community detection algorithms
(e.g., Louvain, Girvan-Newman) to automatically discover <strong>product clusters</strong>,
or for visualising cross-selling patterns as a force-directed graph.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-119-1"><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.viz</span><span class="w"> </span><span class="kn">import</span> <span class="n">rusket</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">to_networkx</span>
</span><span id="__span-119-2"><a id="__codelineno-119-2" name="__codelineno-119-2" href="#__codelineno-119-2"></a>
</span><span id="__span-119-3"><a id="__codelineno-119-3" name="__codelineno-119-3" href="#__codelineno-119-3"></a><span class="n">rusket</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">(</span><span class="n">rules_df</span><span class="p">:</span> <span class="s1">&#39;pd.DataFrame&#39;</span><span class="p">,</span> <span class="n">source_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;antecedents&#39;</span><span class="p">,</span> <span class="n">target_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;consequents&#39;</span><span class="p">,</span> <span class="n">edge_attr</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;lift&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;networkx.DiGraph&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>rules_df</td>
<td>pd.DataFrame</td>
<td>A Pandas DataFrame generated by <code>rusket.association_rules()</code>.</td>
</tr>
<tr>
<td>source_col</td>
<td>str, default='antecedents'</td>
<td>Column name containing antecedents (graph edge sources).</td>
</tr>
<tr>
<td>target_col</td>
<td>str, default='consequents'</td>
<td>Column name containing consequents (graph edge targets).</td>
</tr>
<tr>
<td>edge_attr</td>
<td>str, default='lift'</td>
<td>The metric to use as edge weight/thickness.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>networkx.DiGraph</td>
<td></td>
<td>A directed graph of the association rules. If <code>rules_df</code> is empty, returns an empty <code>DiGraph</code>.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Notes</strong>
Requires the <code>networkx</code> package (<code>pip install networkx</code>).
When multiple rules produce the same directed edge, only the highest-weight
rule is retained.</p>
</blockquote>
<p><strong>Examples</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-120-1"><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">rusket</span>
</span><span id="__span-120-2"><a id="__codelineno-120-2" name="__codelineno-120-2" href="#__codelineno-120-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">G</span> <span class="o">=</span> <span class="n">rusket</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">(</span><span class="n">rules_df</span><span class="p">,</span> <span class="n">edge_attr</span><span class="o">=</span><span class="s2">&quot;lift&quot;</span><span class="p">)</span>
</span><span id="__span-120-3"><a id="__codelineno-120-3" name="__codelineno-120-3" href="#__codelineno-120-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Community detection with networkx</span>
</span><span id="__span-120-4"><a id="__codelineno-120-4" name="__codelineno-120-4" href="#__codelineno-120-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">networkx.algorithms.community</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx_comm</span>
</span><span id="__span-120-5"><a id="__codelineno-120-5" name="__codelineno-120-5" href="#__codelineno-120-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">communities</span> <span class="o">=</span> <span class="n">nx_comm</span><span class="o">.</span><span class="n">greedy_modularity_communities</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">())</span>
</span></code></pre></div>
<hr />
<h2 id="distributed-spark-api-rusketspark">Distributed Spark API (<code>rusket.spark</code>)<a class="headerlink" href="#distributed-spark-api-rusketspark" title="Permanent link">&para;</a></h2>
<p>All functions in <code>rusket.spark</code> distribute computation across PySpark partitions using Apache Arrow (zero-copy) for maximum throughput.</p>
<h3 id="rusketsparkmine_grouped"><code>rusket.spark.mine_grouped</code><a class="headerlink" href="#rusketsparkmine_grouped" title="Permanent link">&para;</a></h3>
<p>Distribute Market Basket Analysis across PySpark partitions.</p>
<p>This function groups a PySpark DataFrame by <code>group_col</code> and applies
<code>rusket.mine</code> to each group concurrently across the cluster.</p>
<p>It assumes the input PySpark DataFrame is formatted like a dense
boolean matrix (One-Hot Encoded) per group, where rows are transactions.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-121-1"><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.spark</span><span class="w"> </span><span class="kn">import</span> <span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">mine_grouped</span>
</span><span id="__span-121-2"><a id="__codelineno-121-2" name="__codelineno-121-2" href="#__codelineno-121-2"></a>
</span><span id="__span-121-3"><a id="__codelineno-121-3" name="__codelineno-121-3" href="#__codelineno-121-3"></a><span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">mine_grouped</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">group_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">use_colnames</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>df</td>
<td></td>
<td>The input <code>pyspark.sql.DataFrame</code>.</td>
</tr>
<tr>
<td>group_col</td>
<td></td>
<td>The column to group by (e.g. <code>store_id</code>).</td>
</tr>
<tr>
<td>min_support</td>
<td></td>
<td>Minimum support threshold.</td>
</tr>
<tr>
<td>max_len</td>
<td></td>
<td>Maximum itemset length.</td>
</tr>
<tr>
<td>method</td>
<td></td>
<td>Algorithm to use: 'auto', 'fpgrowth', or 'eclat'.</td>
</tr>
<tr>
<td>use_colnames</td>
<td></td>
<td>If True, returns item names instead of column indices. Must be True for PySpark <code>applyInArrow</code> schema consistency.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pyspark.sql.DataFrame</td>
<td></td>
<td>A PySpark DataFrame containing: - <code>group_col</code> - <code>support</code> (float) - <code>itemsets</code> (array of strings)</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="rusketsparkrules_grouped"><code>rusket.spark.rules_grouped</code><a class="headerlink" href="#rusketsparkrules_grouped" title="Permanent link">&para;</a></h3>
<p>Distribute Association Rule Mining across PySpark partitions.</p>
<p>This takes the frequent itemsets DataFrame (output of <code>mine_grouped</code>)
and applies <code>association_rules</code> uniformly across the groups.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-122-1"><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.spark</span><span class="w"> </span><span class="kn">import</span> <span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">rules_grouped</span>
</span><span id="__span-122-2"><a id="__codelineno-122-2" name="__codelineno-122-2" href="#__codelineno-122-2"></a>
</span><span id="__span-122-3"><a id="__codelineno-122-3" name="__codelineno-122-3" href="#__codelineno-122-3"></a><span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">rules_grouped</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">group_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">num_itemsets</span><span class="p">:</span> <span class="s1">&#39;dict[Any, int] | int&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;confidence&#39;</span><span class="p">,</span> <span class="n">min_threshold</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>df</td>
<td></td>
<td>The PySpark <code>DataFrame</code> containing frequent itemsets.</td>
</tr>
<tr>
<td>group_col</td>
<td></td>
<td>The column to group by.</td>
</tr>
<tr>
<td>num_itemsets</td>
<td></td>
<td>A dictionary mapping group IDs to their total transaction count, or a single integer if all groups have the same number of transactions.</td>
</tr>
<tr>
<td>metric</td>
<td></td>
<td>The metric to filter by (e.g. "confidence", "lift").</td>
</tr>
<tr>
<td>min_threshold</td>
<td></td>
<td>The minimal threshold for the evaluation metric.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pyspark.sql.DataFrame</td>
<td></td>
<td>A DataFrame containing antecedents, consequents, and all rule metrics, prepended with the <code>group_col</code>.</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="rusketsparkprefixspan_grouped"><code>rusket.spark.prefixspan_grouped</code><a class="headerlink" href="#rusketsparkprefixspan_grouped" title="Permanent link">&para;</a></h3>
<p>Distribute Sequential Pattern Mining (PrefixSpan) across PySpark partitions.</p>
<p>This function groups a PySpark DataFrame by <code>group_col</code> and applies
<code>PrefixSpan.from_transactions</code> to each group concurrently across the cluster.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-123-1"><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.spark</span><span class="w"> </span><span class="kn">import</span> <span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">prefixspan_grouped</span>
</span><span id="__span-123-2"><a id="__codelineno-123-2" name="__codelineno-123-2" href="#__codelineno-123-2"></a>
</span><span id="__span-123-3"><a id="__codelineno-123-3" name="__codelineno-123-3" href="#__codelineno-123-3"></a><span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">prefixspan_grouped</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">group_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">user_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">time_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>df</td>
<td></td>
<td>The input <code>pyspark.sql.DataFrame</code>.</td>
</tr>
<tr>
<td>group_col</td>
<td></td>
<td>The column to group by (e.g. <code>store_id</code>).</td>
</tr>
<tr>
<td>user_col</td>
<td></td>
<td>The column identifying the sequence within each group (e.g., <code>user_id</code> or <code>session_id</code>).</td>
</tr>
<tr>
<td>time_col</td>
<td></td>
<td>The column used for ordering events within a sequence.</td>
</tr>
<tr>
<td>item_col</td>
<td></td>
<td>The column containing the items.</td>
</tr>
<tr>
<td>min_support</td>
<td></td>
<td>The minimum absolute support (number of sequences a pattern must appear in).</td>
</tr>
<tr>
<td>max_len</td>
<td></td>
<td>Maximum length of the sequential patterns to mine.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pyspark.sql.DataFrame</td>
<td></td>
<td>A PySpark DataFrame containing: - <code>group_col</code> - <code>support</code> (long/int64) - <code>sequence</code> (array of strings)</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="rusketsparkhupm_grouped"><code>rusket.spark.hupm_grouped</code><a class="headerlink" href="#rusketsparkhupm_grouped" title="Permanent link">&para;</a></h3>
<p>Distribute High-Utility Pattern Mining (HUPM) across PySpark partitions.</p>
<p>This function groups a PySpark DataFrame by <code>group_col</code> and applies
<code>HUPM.from_transactions</code> to each group concurrently across the cluster.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-124-1"><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.spark</span><span class="w"> </span><span class="kn">import</span> <span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">hupm_grouped</span>
</span><span id="__span-124-2"><a id="__codelineno-124-2" name="__codelineno-124-2" href="#__codelineno-124-2"></a>
</span><span id="__span-124-3"><a id="__codelineno-124-3" name="__codelineno-124-3" href="#__codelineno-124-3"></a><span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">hupm_grouped</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">group_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">transaction_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">item_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">utility_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">min_utility</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">max_len</span><span class="p">:</span> <span class="s1">&#39;int | None&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>df</td>
<td></td>
<td>The input <code>pyspark.sql.DataFrame</code>.</td>
</tr>
<tr>
<td>group_col</td>
<td></td>
<td>The column to group by (e.g. <code>store_id</code>).</td>
</tr>
<tr>
<td>transaction_col</td>
<td></td>
<td>The column identifying the transaction within each group.</td>
</tr>
<tr>
<td>item_col</td>
<td></td>
<td>The column containing the numeric item IDs.</td>
</tr>
<tr>
<td>utility_col</td>
<td></td>
<td>The column containing the numeric utility (e.g., profit) of the item in the transaction.</td>
</tr>
<tr>
<td>min_utility</td>
<td></td>
<td>The minimum total utility required to consider a pattern "high-utility".</td>
</tr>
<tr>
<td>max_len</td>
<td></td>
<td>Maximum length of the itemsets to mine.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pyspark.sql.DataFrame</td>
<td></td>
<td>A PySpark DataFrame containing: - <code>group_col</code> - <code>utility</code> (double/float64) - <code>itemset</code> (array of longs/int64)</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="rusketsparkrecommend_batches"><code>rusket.spark.recommend_batches</code><a class="headerlink" href="#rusketsparkrecommend_batches" title="Permanent link">&para;</a></h3>
<p>Distribute Batch Recommendations across PySpark partitions.</p>
<p>This function uses <code>mapInArrow</code> to process partitions of users concurrently,
applying a pre-fitted <code>Recommender</code> (or <code>ALS</code>) to each chunk.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-125-1"><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.spark</span><span class="w"> </span><span class="kn">import</span> <span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">recommend_batches</span>
</span><span id="__span-125-2"><a id="__codelineno-125-2" name="__codelineno-125-2" href="#__codelineno-125-2"></a>
</span><span id="__span-125-3"><a id="__codelineno-125-3" name="__codelineno-125-3" href="#__codelineno-125-3"></a><span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">recommend_batches</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">user_col</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span> <span class="o">=</span> <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>df</td>
<td></td>
<td>The PySpark <code>DataFrame</code> containing user histories (must contain <code>user_col</code>).</td>
</tr>
<tr>
<td>model</td>
<td></td>
<td>The pre-trained <code>Recommender</code> or <code>ALS</code> model instance to use for scoring.</td>
</tr>
<tr>
<td>user_col</td>
<td></td>
<td>The column identifying the user.</td>
</tr>
<tr>
<td>k</td>
<td></td>
<td>The number of top recommendations to return per user.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pyspark.sql.DataFrame</td>
<td></td>
<td>A DataFrame with two columns: - <code>user_col</code> - <code>recommended_items</code> (array of longs/int64)</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="rusketsparkto_spark"><code>rusket.spark.to_spark</code><a class="headerlink" href="#rusketsparkto_spark" title="Permanent link">&para;</a></h3>
<p>Convert a Pandas or Polars DataFrame into a PySpark DataFrame.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-126-1"><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rusket.spark</span><span class="w"> </span><span class="kn">import</span> <span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">to_spark</span>
</span><span id="__span-126-2"><a id="__codelineno-126-2" name="__codelineno-126-2" href="#__codelineno-126-2"></a>
</span><span id="__span-126-3"><a id="__codelineno-126-3" name="__codelineno-126-3" href="#__codelineno-126-3"></a><span class="n">rusket</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">to_spark</span><span class="p">(</span><span class="n">spark_session</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>spark_session</td>
<td></td>
<td>The active PySpark <code>SparkSession</code>.</td>
</tr>
<tr>
<td>df</td>
<td></td>
<td>The <code>pd.DataFrame</code> or <code>pl.DataFrame</code> to convert.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pyspark.sql.DataFrame</td>
<td></td>
<td>The resulting PySpark DataFrame.</td>
</tr>
</tbody>
</table>
<hr />














                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://zensical.org/" target="_blank" rel="noopener">
      Zensical
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/bmsuisse/rusket" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/rusket/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      
      <script id="__config" type="application/json">{"annotate":null,"base":"..","features":[],"search":"../assets/javascripts/workers/search.e2d2d235.min.js","tags":null,"translations":{"clipboard.copied":"Copied to clipboard","clipboard.copy":"Copy to clipboard","search.result.more.one":"1 more on this page","search.result.more.other":"# more on this page","search.result.none":"No matching documents","search.result.one":"1 matching document","search.result.other":"# matching documents","search.result.placeholder":"Type to start searching","search.result.term.missing":"Missing","select.version":"Select version"},"version":null}</script>
    
    
      <script src="../assets/javascripts/bundle.5fcf0de6.min.js"></script>
      
    
  </body>
</html>